---
title             : "ELSSP"
shorttitle        : "ELSSP"


author: 
  - name          : "Erin Campbell"
    affiliation   : "1"
    corresponding : yes    
    email         : "erin.e.campbell@duke.edu"
    address       : "Address here"
  - name          : "Elika Bergelson"
    affiliation   : "1"

affiliation:
  - id            : "1"
    institution   : "Duke University"


keywords          : "keywords"
wordcount         : "X"

bibliography      : ["ELSSP.bib"]

floatsintext      : no
figurelist        : no
tablelist         : no
footnotelist      : no
linenumbers       : no
mask              : no
draft             : no

documentclass     : "apa6"
classoption       : "man"
output            : papaja::apa6_pdf
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r load-packages, cache = FALSE, include = FALSE, echo=FALSE}
library(papaja) 
library(tidyverse)
library(knitr)
library(lubridate)
library(kableExtra)
library(citr)
library(readxl)
library(broom)
library(stargazer)
library(glue)
library(magick)

knitr::opts_chunk$set(fig.width=12, fig.height=12, comment=F, message=F, hide = T, warning = F, echo = F)
```

```{r read-in-data, echo = F, results = 'hide', message = F, comment = F, fig.show='hide'}
source('functions_and_df_prep.R')
comorbid <- read.csv("data/elssp_comorbidities.csv")
```

# Introduction
In the United States, 1-2 children are born with hearing loss, per 1,000 births [@cdc2018]. This translates to 114,000 Deaf or Hard of Hearing (DHH) children born in the U.S. per year [@martin2019]. Of these 114,000, ~90% will be born to hearing parents [@mitchell2004], in a home where spoken language is likely the dominant communication method. Depending on the type and degree of hearing loss and whether the child uses amplification, spoken linguistic input will be partially or totally inaccessible. Some of these children will develop spoken language within the range of their hearing peers [@verhaert2008; @geers2017], but many will face persistent spoken language deficits [@eisenberg2007; @moeller2007; @luckner2010; @sarchet2014], which may later affect reading ability [@kyle2010] and academic achievement [@qi2012; @karchmer2003]. 

Despite many excellent studies examining language development in DHH children, there is still a gap in the literature describing and analyzing spoken language development across the full range of children receiving state services for hearing loss, with many studies focusing in on specific subgroups (e.g. children under age X with Y level of hearing loss and Z amplification approach, e.g. [@yoshinaga-itano2018; @vohr2008]). In what follows, we first summarize the previous literature on predictors of spoken language outcomes in DHH children. We then provide  a brief overview of a common vocabulary measure used in the current study, the MacArthur-Bates Communicative Development Inventory (CDI). Finally, we turn to an empirical analysis of  early vocabulary in a wide range of young children receiving state services in North Carolina. We have two broad goals in what follows. First, we aim to provide a comprehensive description of a heterogeneous group of young children who receive state services for hearing loss. Second, we aim to connect the intervention approaches and child characteristics of this sample with children’s vocabulary, with the broader goal of considering the success of early diagnosis and intervention initiatives. 

## Predictors of Language Outcomes
Though the literature points towards spoken language delays and deficits for DHH children, this is a highly variable population with highly variable outcomes [@pisoni2018]. Previous research indicates that gender [@kiese-himmel2002a; @ching2013], additional disability [@ching2013; @yoshinaga-itano2017; @verhaert2008], degree and configuration of hearing loss [@ching2013; @dediego-lazaro2018; @vohr2011; @yoshinaga-itano2017], amplification [@walker2015], communication [@geers2017], and early diagnosis/intervention [@yoshinaga-itano2017; @yoshinaga-itano2018] predict language outcomes in DHH children.

### Gender
For hearing children, the literature points to a female gender advantage in early language acquisition. Girls speak their first word earlier [@macoby1966], have a larger [@bornstein2004; @fenson1994; @frank2017] and faster-growing vocabulary [@huttenlocher1991], and stronger grammatical and phonological skills [@lange2016; @ozcaliskan2010]. This finding appears to be consistent across studies [@wallentin2009], various spoken languages [@frank2019], and gesture [@ozcaliskan2010]. 

The DHH literature presents a more mixed (though rather understudied) picture. On one hand, DHH girls,  like hearing girls, have been found to have a larger spoken vocabulary than DHH boys [@kiese-himmel2002a; @ching2013]. However, in contrast to their hearing peers, DHH children do not seem to show a gender-based difference for some aspects of syntactic development [@pahlavannezhad2014].

### Comorbidities
Additional co-occuring disabilities occur frequently in the DHH population, perhaps as much as three times more than in the hearing population [@pollack1997]. Incidence estimates for co-occurring disabilities in DHH children range from 25-51% [@bruce2015; @guardino2008; @luckner2001; @picard2004; @schildroth1996; @soukup2007; @holden-pitt1998], with approximately 8% children living with 2 or more co-occurring disabilities [@schildroth1996]. 

Some of these conditions, particularly those which carry risk of developmental delay (e.g., Down syndrome), result in language delays independent of hearing loss [@chapman1997; @kristoffersen2008; @weismer2010], with cognitive ability more predictive of language outcomes than presence or absence of a specific disability [@meinzen-derr2011; @sarant2008]. Disability and hearing loss likely each contribute to a given child’s language development [@rajput2003; @vannierop2016; @ching2013], with differential effects of each [@vesseur2016]. In some cases, additional disabilities appear to interact with hearing loss to intensify developmental delays [@birman2012; @pierson2007].

Furthermore, incidence of hearing loss is higher among children born premature (defined as < 37 weeks gestational age). Compared to an incidence 0.2% in full-term infants, incidence of hearing loss in extremely premature infants (defined as < 33 weeks gestational age) ranges 2--11%, with increased prematurity associated with increased rates of hearing loss [@wroblewska-seniuk2017]. 

Independently of hearing status, prematurity is linked to increased risk of language delay and disorder [@rechia2016; @vannoort-vanderspek2012; @carter2017; @vohr2014; @cusson2003; @barre2011]. Unfortunately, research on language development in premature DHH children is scant [@vohr2016], so it remains unclear how hearing loss and prematurity may interact within spoken language skills. One study of premature infants finds that auditory brainstem response during newborn hearing screening predicts language performance on the PLS-4 at age 3 [@amin2014], suggesting a link between prematurity and hearing loss in early childhood, though further research is needed in this domain. In extremely premature DHH children, incidence of additional disabilities may be as high as 73% [@robertson2009]. Indeed, pre-term infants with comorbidities have been found to be more likely to also have hearing loss than those without comorbidities [@schmidt2003], further complicating language development for this population.

### Audiological Characteristics
Hearing loss varies in severity, ranging from slight to profound [@clark1981]. More severe hearing loss (less access to spoken language) typically results in more difficulty with spoken language in infancy [@vohr2008], early childhood [@ching2010; @ching2013; @tomblin2015; @sarant2008; @sininger2010] and school-age [@wake2004]. Although profound hearing loss is associated with more pronounced spoken language difficulty, even mild to moderate hearing loss is associated with elevated risk of language disorders [@delage2007; @blair1985].

Hearing loss also varies in whether it affects one ear or both. Bilateral hearing assists speech perception, sound localization, and loudness perception in quiet and noisy environments [@ching2007]. The literature on hearing aids and cochlear implants also points to benefits for bilateral auditory input [@sarant2014; @lovett2010; @smulders2016]. At school-age, 3--6% of children have unilateral hearing loss [@ross2010]. Although children with unilateral hearing loss have one “good ear,” even mild unilateral hearing loss has been tied to higher risk of language delays and educational challenges relative to hearing children [@vila2015; @lieu2013; @lieu2004; @lieu2012; @kiese-himmel2002]. That is, just as in the bilateral case, more severe hearing loss leads to greater deficits in language and educational outcomes for children with unilateral hearing loss [@lieu2013;@anne2017]. 

Many DHH children receive hearing aids (HAs) or cochlear implants (CIs) to boost access to the aural world. These devices have been associated with better speech perception and spoken language outcomes [@walker2015; @waltzman1997; @niparko2010]. In turn, aided audibility predicts lexical abilities with children in HAs [@stiles2012]. 

For both hearing aids and cochlear implants, earlier fit leads to better spoken language skills, if the amplification is effective. For hearing aids, some studies find that children with milder hearing loss who receive hearing aids earlier have better early language achievement than children who are fit later [@tomblin2015], but this finding does not hold for children with severe to profound hearing loss [@kiese-himmel2002; @watkin2007] (for whom hearing aids are generally ineffective). Analogously, children who are eligible and receive cochlear implants earlier have better speech perception and spoken language outcomes than those implanted later [@dettman2007; @miyamoto2008; @svirsky2004; @yoshinaga-itano2018; @artieres2009], with best outcomes for children receiving implants before their first birthday [@dettman2007]. 

### Communication
Total Communication (TC) refers to communication that combines speech, gesture, and elements of sign (but not a full sign language, such as American Sign Language), sometimes simultaneously. Clinicians currently employ TC as an alternative or augmentative communication method for children with a wide range of disabilities [@branson2009; @gibbs1991; @mirenda2003].

Compared to total communication, DHH children using an exclusively oral approach have better speech intelligibility [@geers2017; @dillon2004; @geers2002; @hodges1999] and auditory perception [@geers2017; @odonoghue2000]. That said, there is some debate as to whether an oral approach facilitates higher spoken language performance, or whether children who demonstrate aptitude for spoken language are steered towards the oral approach rather than TC [@hall2017].

### 1-3-6 Guidelines
Early identification [@yoshinaga-itano2018; @yoshinaga-itano1998; @white1987; @robinshaw1995; @apuzzo1995; @kennedy2006] and timely enrollment in early intervention programs [@vohr2008; @watkin2007; @ching2013; @holzinger2011; @vohr2011] are associated with better language proficiency. Indeed, DHH children who receive prompt diagnosis and early access to services have been found to meet age-appropriate developmental outcomes, including language [@stika2015]. 

In line with these findings, the American Academy of Pediatricians (AAP) has set an initiative for Early Hearing Detection and Intervention (EHDI). Their EHDI guidelines recommend that DHH children are screened by 1 month old, diagnosed by 3 months old, and enter early intervention services by 6 months old. We refer to this guideline as 1-3-6. Meeting this standard appears to improve spoken language outcomes for children with HL [@yoshinaga-itano2017; @yoshinaga-itano2018] and the benefits appear consistent across a range of demographic characteristics. 

At a federal level in the U.S., the Early Hearing Detection and Intervention Act of 2010 [@capps2009] was passed to develop state-wide systems for screening, evaluation, diagnosis, and “appropriate education, audiological, medical interventions for children identified with hearing loss,” but policies for early diagnosis and intervention vary by state.  As of 2011, 36 states (including North Carolina, @2000] mandate universal newborn hearing screening [@nationalconferenceofstatelegislatures2011]. All states have some form of  early intervention programs that children with hearing loss can access [@nad], but these also vary state-by-state. For instance, half of the states in the US do not consider mild hearing loss an eligibility criterion for early intervention [@holstrum2008].

In evaluating the success of this initiative, the AAP [@ehdi] finds that about 70% of US children who fail their newborn hearing screening test are diagnosed with hearing loss before 3 months old, and that 67% of those diagnosed (46% of those that fail newborn hearing screening) begin early intervention services by 6 months old. These findings suggest that there may be breaks in the chain from screening to diagnosis and from diagnosis to intervention, and the effect may be further delays in language development for children not meeting these guidelines.
 
## Quantifying vocabulary growth in DHH children
The MacArthur Bates Communicative Development Inventory [CDI, @fenson1994] is a parent-report instrument that gathers information about children’s vocabulary development. The Words and Gestures version of the form (CDI-WG) is normed for 8-18-month-olds, and includes 398 vocabulary items that parents indicate whether their child understands or produces, along with  questions about young children’s early communicative milestones.  The Words and Sentences version of the form (CDI-WS) is normed for 16-30-month-olds, and includes 680 vocabulary items that parents indicate whether their child produces, along with some questions about grammatical development. The CDI has been normed on a large set of participants across many languages [@anderson2002; @frank2017; @jackson-maldonado2003]. 

The CDI has also been validated for DHH children with cochlear implants [@thal2007]. More specifically, in this validation, researchers asked parents to complete the CDI, administered the Reynell Developmental Language Scales, and collected a spontaneous speech sample. All comparisons between the CDI and the other measures yielded significant correlations ranging from 0.58 to 0.93. Critically, the children in this study were above the normed age range for the CDI, and thus this validation helps to confirm that the CDI is a valid measurement tool for older DHH children. In further work, @castellanos2016 finds that in children with CIs, number of words produced on the CDI predicts language, executive function, and academic skills up to 16 years later. Building on this work, several studies have used the CDI to measure vocabulary development in DHH children [@ching2013; @yoshinaga-itano2017; @yoshinaga-itano2018; @dediego-lazaro2018; @vohr2008; @vohr2011; summarized in table XXX]. 


```{r CDIsummary}

research_table <- tribble(
  ~Study, ~Population,  ~Gender, ~'1-3-6', ~Laterality, ~Degree, ~Amplification, ~Communication, ~Comorbidities,
  "Ching et al., 2013", "3 year old children receiving services in Australia", "Female +", "Did not study", "Did not study", "More severe -", "No effect", "No effect", "Comorbidities -",
  "Yoshinaga-Itano et al., 2017", "8-39 month children with bilateral hearing loss", "No effect", "1-3-6 +", "Did not study", "More severe -", "Did not study", "Did not study", "Comorbidities -",
  "Yoshinaga-Itano et al., 2018", "Children with cochlear implants", "Did not study", "1-3-6 +", "Did not study", "Did not study", "Earlier CI activation +", "Did not study", "Did not study",
  "De Diego-Lazaro et al., 2018", "Spanish speaking children with bilateral hearing loss", "No effect", "Earlier intervention +", "Did not study", "Milder +", "More functional hearing +", "Did not study", "Did not study",
  "Vohr et al., 2011", "18-24 month olds with hearing loss", "Did not study", "Earlier intervention +", "Did not study", "Milder +", "Did not study", "Did not study", "NICU stay -; Comorbidities -"
)

kable(research_table,
      caption = "Summary of findings of CDI studies in DHH children") %>%
  kable_styling(latex_options = c("scale_down")) %>%
  add_footnote("+ equals bigger vocab, - equals smaller vocab")



```

## Goals and Predictions
This study aims to 1) characterize the demographic, audiological, and intervention variability in the population of DHH children receiving state services for hearing loss; 2) identify predictors of vocabulary delays; and 3) evaluate the success of early identification and intervention efforts at a state level. We include two subgroups of DHH children traditionally excluded from studies of language development: children with additional disabilities and children with unilateral hearing loss [e.g., @yoshinaga-itano2018]. 

For the first and third goal above, we did not have specific hypotheses and sought to provide descriptive information about a diverse sample of DHH children receiving state services. For the second, we hypothesized that male gender, more severe degree of hearing loss,  bilateral hearing loss, no amplification use, prematurity, and presence of additional disabilities would predict larger spoken vocabulary delay. We did not have strong predictions regarding communication method, language background, or presence of other health issues (e.g., congenital heart malformation).

# Methods
``` {r demo-data}
num_subs <- nrow(elssp)
num_repeat_subs <- nrow(elssp %>% filter(VisitTotal > 1)) 
num_girls <- nrow(elssp %>% filter(Gender == 'female'))
num_boys <- nrow(elssp %>% filter(Gender == 'male'))
min_age <- min(elssp$Age)
max_age <- max(elssp$Age)
mean_age <- mean(elssp$Age)
sd_age <- sd(elssp$Age)
num_too_old_wg <- nrow(wg_elssp %>% filter(Age>18))
num_spanish_cdi <- nrow(elssp %>% filter(PrimaryLanguage == 'Spanish'))
```

Clinical evaluations were obtained through an ongoing collaboration with  the North Carolina Early Language Sensory Support Program (ELSSP), an early intervention program serving children with sensory impairments from birth to 36 months. ELSSP passed along deidentified evaluations to our team after obtaining consent to do so from each family. No eligibility criteria beyond hearing loss and receiving an ELSSP evaluation were imposed, given our goal of characterizing the full range of DHH children with hearing loss in North Carolina.

The clinical evaluations included demographic and audiological information, CDI vocabulary scores, and the results of any clinical assessments administered (e.g., PPVT), all detailed further below. For some children (n=`r num_repeat_subs`), multiple evaluations were available from different timepoints. In these cases, only the first evaluation was considered for this study, due to concerns regarding within-subjects variance for statistical analysis.

While this collaboration is ongoing, we opted to pause for this analysis upon receiving data from 100 children. Thus, the reported sample below consists of `r num_subs` children (`r num_boys` male / `r num_girls` female) ages `r min_age`--`r max_age`(M=`r mean_age`, SD=`r sd_age`). Race and SES information was not available. Families were administered either the WG or WS version of the CDI based on clinician judgement. Children who were too old for WG, but who were not producing many words at the time of assessment, were often given WG (n=`r num_too_old_wg`). Families for whom Spanish was the primary language (n = `r num_spanish_cdi`) completed the Spanish version of the CDI [@jackson-maldonado2003].

```{r CDIinfo, echo=FALSE}
WG_n <- nrow(wg_elssp)
WS_n <- nrow(ws_elssp)
WG_age <- mean(wg_elssp$Age)
WG_age_sd <- sd(wg_elssp$Age)
WS_age <- mean(ws_elssp$Age)
WS_age_sd <- sd(ws_elssp$Age)
WG_comp <- mean(wg_elssp$ComprehensionCDI, na.rm = TRUE)
WS_comp <- mean(ws_elssp$ComprehensionCDI)
WG_comp_sd <- sd(wg_elssp$ComprehensionCDI, na.rm = TRUE)
WS_comp_sd <- sd(ws_elssp$ComprehensionCDI)
WG_prod <- mean(wg_elssp$ProductionCDI, na.rm = TRUE)
WS_prod <- mean(ws_elssp$ProductionCDI, na.rm = TRUE)
WG_prod_sd <- sd(wg_elssp$ProductionCDI, na.rm = TRUE)
WS_prod_sd <- sd(ws_elssp$ProductionCDI, na.rm = TRUE)
WG_percDD <- ((nrow(wg_elssp %>% filter(DevelopmentalConcerns=='yes')))/(nrow(wg_elssp)))*100
WS_percDD <- ((nrow(ws_elssp %>% filter(DevelopmentalConcerns=='yes')))/(nrow(ws_elssp)))*100

CDI_table <- tribble(
  ~'CDI version', ~'Average Age (SD)',  ~'Average Comprehension (SD)', ~'Average Production (SD)', ~'% Developmental Delays',
  glue('WG (n={WG_n})'), glue('{round(WG_age, digits=2)} ({round(WG_age_sd, digits=2)}) months'), glue('{round(WG_comp, digits=0)} ({round(WG_comp_sd, digits=1)}) words'), glue('{round(WG_prod, digits=0)} ({round(WG_prod_sd,digits=1)}) words'), glue('{round(WG_percDD, digits=2)}%'),
  glue('WS (n={WS_n})'), glue('{round(WS_age, digits=2)} ({round(WS_age_sd, digits=2)}) months'), glue({WS_comp}), glue('{round(WS_prod, digits=0)} ({round(WS_prod_sd, digits=1)}) words'), glue('{WS_percDD}%'))



kable(CDI_table,
      caption = "CDI details") %>%
  kable_styling(latex_options = c("scale_down"))

```

Children in this sample were coded as yes/no for cognitive development concerns (e.g., Down syndrome, global developmental delays; Cornelia de Lange syndrome), yes/no for prematurity (i.e., more than 3 weeks premature), yes/no for health issues (e.g., heart defects, kidney malformations, VACTERL association), and yes/no for vision loss (not corrected to normal by surgery or glasses)

```{r comorbid-info}
num_premature <- nrow(comorbid %>% filter(WeeksGestation<37))
num_v_premature <- nrow(comorbid %>% filter(WeeksGestation<33))
num_NICU <- nrow(comorbid %>% filter(NICU==1))
num_prem_NICU <- (nrow(comorbid%>%filter(NICU==1&IsPremature==1))/(nrow(elssp %>% filter(IsPremature==1))))*100

num_vision_loss <- nrow(comorbid %>% filter(VisionLoss==1))
num_ROP <- nrow(comorbid %>% filter(RetinopathyOfPrematurity==1))
num_hyperopia <- nrow(comorbid %>% filter(hyperopia==1))
num_cvi <- nrow(comorbid %>% filter(corticalvisualimpairment==1))
num_myopia <- nrow(comorbid %>% filter(myopia==1))

num_dev_delay <- nrow(comorbid %>% filter(DevelopmentalConcerns==1))
num_downsyndrome <- nrow(comorbid %>% filter(downsyndrome==1))
num_otherchromissues <- nrow(comorbid %>% filter(MissingChrom7==1|chromosomalproblems14and15==1))
num_encephalocele <- nrow(comorbid %>% filter(occipitalencephalocele==1|encephalocelecyst))
num_cdl <- nrow(comorbid %>% filter(corneliadelange==1))
num_agenisis_cc <- nrow(comorbid %>% filter(agenesiscorpuscallosum==1))
num_ventricular_issues <- nrow(comorbid %>% filter(intraventricularhemorrhage==1|periventricularleukomalacia==1))
num_hydrocephalus <- nrow(comorbid %>% filter(hydrocephalus==1))
num_overall_dev_concerns <- nrow(comorbid %>% filter(overalldevconcerns==1))
num_apraxia <- nrow(comorbid %>% filter(oculomotorapraxia==1))

num_health_issues <- nrow(comorbid %>% filter(HealthIssues==1))
num_heart_issues <- nrow(comorbid %>% filter(HeartValveProblems==1|heartabnormalities==1|supraventriculartachycardia==1|bradycardia==1|coarctationofaorta==1|patentductusarteriosus|perferatedheart==1|pulmonaryarterystenosis))
num_lung_issues <- nrow(comorbid %>%  filter(asthma==1|bronchopulmonarydysplasia==1|chroniclungdisease|tracheotomy==1|trachoesophagealfistula==1|esophagealatresia==1))
num_feeding_issues <- nrow(comorbid %>% filter(Gtube==1|reflux==1|dysphagia==1|feedingproblems_nos|esophagealatresia==1))
num_illness <- nrow(comorbid %>% filter(chroniclungdisease==1|MRSA==1|meningitis==1|frequentfevers==1|Sepsis==1|jaundice==1|pneumonia==1|cytomegalovirus==1))
num_preg_birth_comp <- nrow(comorbid %>% filter(preeclampsia==1|gestationaldiabetes==1|otherpregnancycomplications==1|jaundice==1|respiratorydistress==1|fetaldistress==1|meconiumaspiration==1))
num_mus_skel <- nrow(comorbid %>% filter(hypertonia==1|torticollis==1|oralmotorweakness==1|missingribs==1|vertebraldefects==1|bonefracture==1|limbabnormalities==1|PDAscoliosis==1|CHARGEorVATER==1|VACTERL==1|treachercollins==1|sagittalsyntosis==1))
num_preg_birth_comp <- nrow(comorbid %>% filter(preeclampsia==1|gestationaldiabetes==1|otherpregnancycomplications==1|jaundice==1|respiratorydistress==1|fetaldistress==1|meconiumaspiration==1|intrauterinegrowthretardation==1))
num_cleft <- nrow(comorbid %>% filter(cleftlip==1|cleftpalate==1))
num_health_issues_other <- nrow(comorbid %>% filter(esotropia==1|iriscoloboma==1|dysplastickidney==1|CHARGEorVATER==1|apnea==1|hydronephrosis==1|seizures==1|laryngomalacia==1|tonguetie==1|midlinedefect==1|hypoglycemia==1|anemia==1|mitochondrialdisorder==1|skinbreakdown==1|VACTERL==1|analatresia==1|renalabnormalities==1|enlargedadenoids==1|liptie==1|sacraldimple==1|enlargedliver==1|petachialrash==1|thrombocytopenia==1))

num_pos_acqHL <- nrow(comorbid %>% filter(anemia==1|MRSA==1|meningitis==1|frequentfevers==1|Sepsis==1|jaundice==1|pneumonia==1|seizures==1|hydrocephalus==1|cytomegalovirus==1))

num_anycomorbid <- nrow(comorbid %>% filter(VisionLoss==1|DevelopmentalConcerns==1|HealthIssues==1|IsPremature==1))

comorbid_table <- tribble(
  ~Condition, ~'Specific Condition',  ~n,
  "Premature", "", num_premature,
  "", "Extremely Premature", num_v_premature,
  "", "NICU stay", num_NICU,
  "Health Issues", "", num_health_issues,
  "", "Heart", num_heart_issues,
  "", "Lung", num_lung_issues,
  "", "Illness", num_illness,
  "", "Feeding Issues", num_feeding_issues,
  "", "Pregnancy/Birth Complications", num_preg_birth_comp,
  "", "Musculoskeletal", num_mus_skel,
  "", "Cleft Lip/Palate", num_cleft,
  "", "Other", num_health_issues_other,
  "Developmental Concerns", "",  num_dev_delay,
  "", "Down Syndrome", num_downsyndrome,
  "", "Chromosomal Issues", num_otherchromissues,
  "", "Neural Tube Defects", num_encephalocele,
  "", "Other", sum(num_agenisis_cc, num_apraxia, num_cvi, num_ventricular_issues, num_hydrocephalus, num_overall_dev_concerns),
  "Vision Loss", "",  num_vision_loss,
  "", "Retinopathy of Prematurity",  num_ROP,
  "", "Nearsightedness",  num_myopia,
  "", "Farsightedness",  num_hyperopia,
  "", "Cortical Visual Impairment",  num_cvi
)


kable(comorbid_table, longtable=T,
      caption = glue::glue("Additional Diagnoses (n={num_anycomorbid})")) %>%
  kable_styling(latex_options = "hold_position") %>%
  add_footnote("N.B. ns do not sum to total because many participants had multiple diagnoses")

```

Degree of hearing loss was most often reported with a written description (e.g., “mild sloping to moderate” or “profound high frequency loss”). We created 3 variables: hearing loss in the better ear, hearing loss in the worse ear, and average hearing loss (average of better and worse ear). Using the ASHA hearing loss guidelines, each of these was coded with a dB HL value corresponding with the median dB HL for the level of hearing loss (e.g., moderate hearing loss was coded as 48dB HL), and sloping hearing loss was coded as the average of the levels (e.g. mild to moderate was coded as 40.5 dB HL). Participants were also coded for unilateral or bilateral hearing loss; presence or absence of Auditory Neuropathy Spectrum Disorder; sensorineural, conditive, or mixed hearing loss. Amplification was recorded as the device the child used at the time of assessment--either hearing aid, cochlear implant, or none.

```{r amp-info}
# This feels like a lot of info in one table. 

n_HA_u <- nrow(elssp %>% filter(Laterality=='Unilateral'&Amplification=='HA'))
n_HA_b <- nrow(elssp %>% filter(Laterality=='Bilateral'&Amplification=='HA'))
n_CI_u <- nrow(elssp %>% filter(Laterality=='Unilateral'&Amplification=='CI'))
n_CI_b <- nrow(elssp %>% filter(Laterality=='Bilateral'&Amplification=='CI'))
n_none_u <- nrow(elssp %>% filter(Laterality=='Unilateral'&Amplification=='none'))
n_none_b <- nrow(elssp %>% filter(Laterality=='Bilateral'&Amplification=='none'))
n_total_u <- nrow(elssp %>% filter(Laterality=='Unilateral'))
n_total_b <- nrow(elssp %>% filter(Laterality=='Bilateral'))

meanbetter_HA_u <- mean((elssp %>% filter(Laterality=='Unilateral'&Amplification=='HA'))$HLbetter)
meanbetter_HA_b <- mean((elssp %>% filter(Laterality=='Bilateral'&Amplification=='HA'))$HLbetter, na.rm = TRUE)
meanbetter_CI_u <- mean((elssp %>% filter(Laterality=='Unilateral'&Amplification=='CI'))$HLbetter)
meanbetter_CI_b <- mean((elssp %>% filter(Laterality=='Bilateral'&Amplification=='CI'))$HLbetter)
meanbetter_none_u <- mean((elssp %>% filter(Laterality=='Unilateral'&Amplification=='none'))$HLbetter)
meanbetter_none_b <- mean((elssp %>% filter(Laterality=='Bilateral'&Amplification=='none'))$HLbetter)
meanbetter_total_u <- mean((elssp %>% filter(Laterality=='Unilateral'))$HLbetter)
meanbetter_total_b <- mean((elssp %>% filter(Laterality=='Bilateral'))$HLbetter, na.rm = TRUE)

meanworse_HA_u <- mean((elssp %>% filter(Laterality=='Unilateral'&Amplification=='HA'))$HLworse, na.rm = TRUE)
meanworse_HA_b <- mean((elssp %>% filter(Laterality=='Bilateral'&Amplification=='HA'))$HLworse, na.rm = TRUE)
meanworse_CI_u <- mean((elssp %>% filter(Laterality=='Unilateral'&Amplification=='CI'))$HLworse)
meanworse_CI_b <- mean((elssp %>% filter(Laterality=='Bilateral'&Amplification=='CI'))$HLworse)
meanworse_none_u <- mean((elssp %>% filter(Laterality=='Unilateral'&Amplification=='none'))$HLworse, na.rm = TRUE)
meanworse_none_b <- mean((elssp %>% filter(Laterality=='Bilateral'&Amplification=='none'))$HLworse)
meanworse_total_u <- mean((elssp %>% filter(Laterality=='Unilateral'))$HLworse, na.rm = TRUE)
meanworse_total_b <- mean((elssp %>% filter(Laterality=='Bilateral'))$HLworse, na.rm = TRUE)

ageamp_HA_u <- mean((elssp %>% filter(Laterality=='Unilateral'&Amplification=='HA'))$AgeAmplification)
ageamp_HA_b <- mean((elssp %>% filter(Laterality=='Bilateral'&Amplification=='HA'))$AgeAmplification, na.rm = TRUE)
ageamp_CI_u <- mean((elssp %>% filter(Laterality=='Unilateral'&Amplification=='CI'))$AgeImplantation)
ageamp_CI_b <- mean((elssp %>% filter(Laterality=='Bilateral'&Amplification=='CI'))$AgeImplantation)
ageamp_total_u <- mean((elssp %>% filter(Laterality=='Unilateral'))$AgeAmplification, na.rm = TRUE)
ageamp_total_b <- mean((elssp %>% filter(Laterality=='Bilateral'))$AgeAmplification, na.rm = TRUE)

n_HA <- nrow(elssp %>% filter(Amplification=='HA'))
n_CI <- nrow(elssp %>% filter(Amplification=='CI'))
n_none <- nrow(elssp %>% filter(Amplification=='none'))


hearing_table <- tribble(
  ~'', ~n, ~'Average HL (better ear)',  ~'Average HL (worse ear)', ~'Average Age at Amplification',
  glue('Hearing Aid (n={n_HA})'), glue('{n_HA_u} / {n_HA_b}'), glue('{round(meanbetter_HA_u, digits=2)} / {round(meanbetter_HA_b, digits=2)} dB'), glue('{round(meanworse_HA_u, digits=2)} / {round(meanworse_HA_b, digits=2)} dB'), glue('{round(ageamp_HA_u, digits=2)} / {round(ageamp_HA_b,digits=2)} months'),
  glue('Cochlear Implant (n={n_CI})'), glue('{n_CI_u} / {n_CI_b}'), glue('NA / {round(meanbetter_CI_b, digits=2)} dB'), glue('NA / {round(meanworse_CI_b, digits=2)} dB'),
  glue('NA / {round(ageamp_CI_b, digits=2)} months'),
  glue('No Amplification (n={n_none})'), glue('{n_none_u} / {n_none_b}'), glue('{round(meanbetter_none_u, digits=2)} / {round(meanbetter_none_b, digits=2)} dB'), glue('{round(meanworse_none_u, digits=2)} / {round(meanworse_none_b, digits=2)} dB'),
  glue('NA'),
  glue('Total (n={nrow(elssp)})'), glue('{n_total_u} / {n_total_b}'), glue('{round(meanbetter_total_u, digits=2)} / {round(meanbetter_total_b, digits=2)} dB'), glue('{round(meanworse_total_u, digits=2)} / {round(meanworse_total_b, digits=2)} dB'),
  glue('NA')
)
 

kable(hearing_table,
      caption = glue::glue("Audiological Characteristics of the Sample \n for Unilateral / Bilateral Hearing Loss")) %>%
  kable_styling(latex_options = c("hold_position", "scale_down")) %>%
  add_footnote("N.B. Age Amplification for children with CIs represents age at implantation")

```

Communication method was recorded as spoken language, total communication, or cued speech. One participant had a parent fluent in sign language, but the reported communication method in the home was total communication. No child in our sample used sign language. Participants were also coded as monolingual or multilingual based on whether families reported using more than one language at home. Total communication was not counted as multilingualism.

```{r comm-info}
n_spoken <- nrow(elssp %>% filter(Communication=='spoken'))
n_CS <- nrow(elssp %>% filter(Communication=='cued speech'))
n_TC <- nrow(elssp %>% filter(Communication=='total communication'))
n_Eng <- nrow(elssp %>% filter(PrimaryLanguage=='English'))
n_Span <- nrow(elssp %>% filter(PrimaryLanguage=='Spanish'))
n_Hindi <- nrow(elssp %>% filter(PrimaryLanguage=='Hindi'))

n_spoken_English <- nrow(elssp %>% filter(Communication=='spoken'&PrimaryLanguage=='English'))
n_spoken_Spanish <- nrow(elssp %>% filter(Communication=='spoken'&PrimaryLanguage=='Spanish'))
n_spoken_Hindi <- nrow(elssp %>% filter(Communication=='spoken'&PrimaryLanguage=='Hindi'))

n_TC_English <- nrow(elssp %>% filter(Communication=='total communication'&PrimaryLanguage=='English'))
n_TC_Spanish <- nrow(elssp %>% filter(Communication=='total communication'&PrimaryLanguage=='Spanish'))
n_TC_Hindi <- nrow(elssp %>% filter(Communication=='total communication'&PrimaryLanguage=='Hindi'))

n_CS_English <- nrow(elssp %>% filter(Communication=='cued speech'&PrimaryLanguage=='English'))
n_CS_Spanish <- nrow(elssp %>% filter(Communication=='cued speech'&PrimaryLanguage=='Spanish'))
n_CS_Hindi <- nrow(elssp %>% filter(Communication=='cued speech'&PrimaryLanguage=='Hindi'))



language_table <- tribble(
  ~'Communication Method', ~English, ~Spanish,  ~Hindi, 
  glue('Spoken Language (n={n_spoken})'), n_spoken_English, n_spoken_Spanish, n_spoken_Hindi,
  glue('Total Communication (n={n_TC})'), n_TC_English, n_TC_Spanish, n_TC_Hindi,
  glue('Cued Speech (n={n_CS})'), n_CS_English, n_CS_Spanish, n_CS_Hindi
)
 

kable(language_table,
      caption = glue::glue("Language and communication characteristics of the sample")) %>%
  kable_styling(latex_options = "hold_position") 
```


Age at screening was measured as the child’s age in months at their first hearing screening. Age at screening was available for `r nrow(elssp %>% filter(NBHS=='Y'))` participants. All participants with a screening age available were screened at birth or while in the NICU. We presume that the vast majority of participants without age at screening received their newborn hearing screening, as North Carolina boasts a 98% NBHS rate (CITE). Age at diagnosis was taken as the age in months when children received their first hearing loss diagnosis. All children were enrolled in birth-to-three early intervention services through NC ELSSP, and the date of enrollment was listed on the clinician evaluation. From the clinician report, we calculated the number of hours of early intervention services received per month (including service coordination, speech therapy, and occupational therapy, among others). 
Because of the sparse data on screening age, if participants had an age at diagnosis  $\leq$ 3 mo. and an age of intervention  $\leq$ 6 mo., they were recorded as meeting 1-3-6. It is possible that a participant did not receive screening by 1 month, but did receive diagnosis by 3 months and services by 6 months. This special case would be coded as meeting 1-3-6 by our criteria.

```{r meets136-info}
# create "Table with meets136 info"
perc_136 <- (nrow(elssp%>%filter(Meets136=='yes'))/(nrow(elssp %>% filter(Meets136=='yes'|Meets136=='no'))))*100
perc_13 <- (nrow(elssp%>%filter(meets13=='yes'))/(nrow(elssp %>% filter(meets13=='yes'|meets13=='no'))))*100
perc_6 <- (nrow(elssp%>%filter(meets6=='yes'))/(nrow(elssp %>% filter(meets6=='yes'|meets6=='no'))))*100

age_diagnosis <- mean(elssp$IdentificationOfHLMonths, na.rm = TRUE)
age_diagnosis_sd <- sd(elssp$IdentificationOfHLMonths, na.rm = TRUE)

age_services <- mean(elssp$AgeStartedServices, na.rm = TRUE)
age_services_sd <- sd(elssp$AgeStartedServices, na.rm = TRUE)

meets136_table <- tribble(
  ~'', ~'', 
'Diagnosis by 3 months', glue('{round(perc_13, digits=2)}%'),
'Average Age Diagnosis (SD)', glue('{round(age_diagnosis, digits=2)} ({round(age_diagnosis_sd, digits=2)}) months'),
'Intervention by 6 months', glue('{round(perc_6, digits=2)}%'),
'Average Age Intervention (SD)', glue('{round(age_services, digits=2)} ({round(age_services_sd, digits=2)}) months'),
'Meets 1-3-6', glue('{round(perc_136, digits=2)}%')
)

kable(meets136_table,
      caption = "Meets 1-3-6 table") %>%
  kable_styling(latex_options = c("hold_position")) 
```

```{r variables-list}

variables_table <- tribble(
  ~Variable, ~Scale, ~ Range, 
'Age', 'Continuous', glue('{min(elssp$Age)}-{round(max(elssp$Age), digits=0)} months'),
'Age at Amplification', 'Continuous', glue('{min(elssp$AgeAmplification, na.rm=TRUE)}-{max(elssp$AgeAmplification, na.rm=TRUE)} months'),
'Age at Diagnosis', 'Continuous', glue('{min(elssp$IdentificationOfHLMonths, na.rm=TRUE)}-{max(elssp$IdentificationOfHLMonths, na.rm=TRUE)} months'),
'Age at Implantation', 'Continuous', glue('{min(elssp$AgeImplantation, na.rm=TRUE)}-{max(elssp$AgeImplantation, na.rm=TRUE)} months'),
'Age at Intervention', 'Continuous', glue('{min(elssp$AgeStartedServices, na.rm=TRUE)}-{max(elssp$AgeStartedServices, na.rm=TRUE)} months'),
'Amplification', 'Categorical', 'Hearing Aid / Cochlear Implant / None',
'Communication', 'Categorical', 'Spoken / Total Communication / Cued Speech',
'Degree Hearing Loss (worse ear)', 'Continuous', glue('{min(elssp$HLworse, na.rm=TRUE)}-{max(elssp$HLworse, na.rm=TRUE)} dB HL'),
'Developmental Delay', 'Categorical', 'Yes / No',
'Gender', 'Categorical', 'Female / Male',
'Health Issues', 'Categorical', 'Yes / No',
'Language in Home', 'Categorical', 'English / Other',
'Laterality', 'Categorical', 'Unilateral / Bilateral',
'Meets 1-3-6', 'Categorical', 'Yes / No',
'Prematurity', 'Categorical', 'Full-term / Premature',
'Services Received Per Month', 'Continuous', glue('{min(elssp$ServicesReceivedPerMonth, na.rm=TRUE)}-{max(elssp$ServicesReceivedPerMonth, na.rm=TRUE)} services per month'),
'Type of Hearing Loss', 'Categorical', 'Sensorineural / Conductive / Mixed',
'CDI - Words Produced', 'Continuous', glue('{min(elssp$ProductionCDI, na.rm=TRUE)}-{max(elssp$ProductionCDI, na.rm=TRUE)} words'),
)

kable(variables_table,
      caption = "Variables table") %>%
  kable_styling(latex_options = "scale_down") 
```

# Results
All analyses were conducted in R. All code is available on Github. In the first section, we explore relationships among child demographic, audiological, and clinical variables. In the second section, we examine the influence of these factors on vocabulary development. In the third section, we describe the implementation of the EHDI 1-3-6 guidelines and predictors of early diagnosis and intervention.

## Part I: Interactions Among Variables

Shapiro–Wilk tests revealed that all of our continuous measures (i.e. degree of hearing loss, services received per month, vocabulary delay) significantly differed from a normal distribution (ps <.05), so we used nonparametric tests to explore relationships among our variables. For categorical-categorical relationships, we used chi square tests; for continuous-categorical tests, we used mann-whitney U tests (2 levels for categorical variable) or kruskal-wallis tests (>2 levels for categorical variable; for continuous-continuous relationships, we used Of the fifty-five combinations of variables, p < .05 for sixteen, and seven survived bonferroni correction (p < `r format.pval(.05/55, digits = 2)`). The full set of comparisons is shown in figure XXX.


```{r relationships-plot}
print(hm_plot)
```

From this analysis, we found that children born premature were more likely to also have health issues `r chisq_output(HealthIssues_Premature)`. Children with conductive hearing loss were more likely to have unilateral hearing loss `r chisq_output(Etiology_Laterality)`. Children with unilateral hearing loss were unlikely to receive a cochlear implant and more likely to use no amplification `r chisq_output(Amplification_Laterality)`. Children with more severe hearing loss were more likely to use a cochlear implant than children with milder hearing loss (H(`r Degree_Amplification$parameter`)=`r Degree_Amplification$statistic`, p=`r Degree_Amplification$p.value`). Children with developmental delays received more services per month than typically developing DHH children (H(`r Services_DevDelay$parameter`)=`r Services_DevDelay$statistic`, p=`r Services_DevDelay$p.value`)and were more likely to use total communication `r chisq_output(DevConcerns_Communication)`. Children who used total communication received more services per month than children using spoken language (H(`r Services_Communication$parameter`)=`r Services_Communication$statistic`, p=`r Services_Communication$p.value`).

## Part II: Influence on vocabulary

We first constructed a binary logistic growth curve for vocabulary from the 50th percentile data for typically developing children from Wordbank. With this function, each participant’s CDI score yielded a predicted age from the normative data. For each child, we subtracted this predicted age (given the score) from the child’s actual age to give us a measure of delay in months. Descriptively, we found widespread vocabulary delays on both Words and Gestures and Words and Sentences, with the majority of DHH children testing around or below the 25th percentile for hearing children. 


```{r wg-ws-rainbow-plot}
cowplot::plot_grid(wg_rainbow, ws_rainbow) +
  labs(caption = "Figures XXX - Colored lines show vocabulary percentiles from wordbank. black line shows growth curve from 50th percentile data. Black triangles show vocabulary scores of individual DHH children.")
```

We next explored the effect of the different audiological, demographic, and intervention characteristics on vocabulary delay. Vocabulary delay did not meet the assumption of normality, so we used non-parametric tests for the following set of analyses. Mann-Whitney-Wilcoxen tests were conducted to examine the effects of gender, laterality, developmental delay, health issues, prematurity, meeting 1-3-6 guidelines, and communication on vocabulary delay. We used kruskal-wallis tests for amplification and etiology, and Kendall’s rank correlations for degree of hearing loss (worse ear) and services received per month. These results are exploratory and descriptive, and their interpretation should be tempered accordingly. 

Boys were significantly more delayed than girls on Words and Sentences but not Words and Gestures. Children with developmental delays had larger vocabulary delays than children without developmental delays on Words and Gestures. Because only one child with a developmental delay took the Words and Sentences form, we did not perform the analysis for Words and Sentences. Premature children and children with health issues had smaller vocabularies than typically developing children on Words and Gestures but not Words and Sentences. Children who met 1-3-6 guidelines had larger vocabulary than children who did not on Words and Gestures but not Words and Sentences. On Words and Gestures but not Words and Sentences, receiving more early intervention services was correlated with lower vocabulary. We did not observe an effect of laterality, communication, degree, or etiology on vocabulary delay on either form of the CDI. For communication, we omitted cued speech from the analysis because only one child in our sample used this method of communication (shown on graph anyway for the curious). A kruskal-wallis test showed a significant effect of amplification on vocabulary delay on Words and Gestures, such that children with no amplification were more delayed than children without amplification.

```{r delay-plots}
# cowplot::plot_grid(wg_gender, wg_prematurity, wg_healthissues, wg_devconcerns, ws_gender, ws_prematurity, ws_healthissues, ws_devconcerns, nrows=2)

# cowplot::plot_grid(wg_laterality, wg_degree, wg_etiology, wg_amplification, ws_laterality, ws_degree, ws_etiology, ws_amplification, rows=2)

# cowplot::plot_grid(wg_gender, wg_prematurity, wg_healthissues, wg_devconcerns, ws_gender, ws_prematurity, ws_healthissues, ws_devconcerns, rows=2)

# cowplot::plot_grid(wg_communication, wg_meets136, wg_services, ws_communication, ws_meets136, ws_services, rows=2)

# cowplot::plot_grid(wg_gender, ws_gender, rows=2)


#right now, only includes graphs where there's a sig relationship between split variable and vocab delay
cowplot::plot_grid(ws_gender, wg_devconcerns, wg_meets136, wg_amplification, wg_healthissues, wg_prematurity, wg_services, rows=3)
```

```{r delay-table}
delay_table <- tribble(
  ~Variable, ~'WG mean delays', ~'WS mean delays', ~Method,
  'Gender', glue('Boy: {round(mean((wg_elssp %>% filter(Gender=="male"))$diff_age_from_expected), digits=1)}; Girl: {round(mean((wg_elssp %>% filter(Gender=="female"))$diff_age_from_expected), digits=1)}'), glue('Boy: {round(mean((ws_elssp %>% filter(Gender=="male"))$diff_age_from_expected), digits=1)}; Girl: {round(mean((ws_elssp %>% filter(Gender=="female"))$diff_age_from_expected), digits=1)}'), 'wilcox', 
 'Laterality', glue('Unilateral: {round(mean((wg_elssp %>% filter(Laterality=="Unilateral"))$diff_age_from_expected), digits=1)}; Bilateral: {round(mean((wg_elssp %>% filter(Laterality=="Bilateral"))$diff_age_from_expected), digits=1)}'), glue('Unilateral: {round(mean((ws_elssp %>% filter(Laterality=="Unilateral"))$diff_age_from_expected), digits=1)}; Bilateral: {round(mean((ws_elssp %>% filter(Laterality=="Bilateral"))$diff_age_from_expected), digits=1)}'), 'wilcox',
    'Amplification', glue('CI: {round(mean((wg_elssp %>% filter(Amplification=="CI"))$diff_age_from_expected), digits=1)}; HA: {round(mean((wg_elssp %>% filter(Amplification=="HA"))$diff_age_from_expected), digits=1)}, none: {round(mean((wg_elssp %>% filter(Amplification=="none"))$diff_age_from_expected), digits=1)}'), glue('CI: {round(mean((ws_elssp %>% filter(Amplification=="CI"))$diff_age_from_expected), digits=1)}; HA: {round(mean((ws_elssp %>% filter(Amplification=="HA"))$diff_age_from_expected), digits=1)}, none: {round(mean((ws_elssp %>% filter(Amplification=="none"))$diff_age_from_expected), digits=1)}'),'kruskall',
   'Health Issues', glue('Yes: {round(mean((wg_elssp %>% filter(HealthIssues==1))$diff_age_from_expected),digits=1)}; No: {round(mean((wg_elssp %>% filter(HealthIssues==0))$diff_age_from_expected), digits=1)}'), glue('Yes: {round(mean((ws_elssp %>% filter(HealthIssues==1))$diff_age_from_expected), digits=1)}; No: {round(mean((ws_elssp %>% filter(HealthIssues==0))$diff_age_from_expected), digits=1)}'), 'wilcox',
   'Developmental Delay', glue('Yes: {round(mean((wg_elssp %>% filter(DevelopmentalConcerns=="yes"))$diff_age_from_expected), digits=1)}; No: {round(mean((wg_elssp %>% filter(DevelopmentalConcerns=="no"))$diff_age_from_expected), digits=1)}'), glue('Yes: {round(mean((ws_elssp %>% filter(DevelopmentalConcerns=="yes"))$diff_age_from_expected), digits=1)}; No: {round(mean((ws_elssp %>% filter(DevelopmentalConcerns=="no"))$diff_age_from_expected), digits=1)}'), 'wilcox', 
    'Prematurity', glue('Premature: {round(mean((wg_elssp %>% filter(IsPremature==1))$diff_age_from_expected), digits=1)}; Full-term: {round(mean((wg_elssp %>% filter(IsPremature==0))$diff_age_from_expected), digits=1)}'), glue('Premature: {round(mean((ws_elssp %>% filter(IsPremature==1))$diff_age_from_expected), digits=1)}; Full-term: {round(mean((ws_elssp %>% filter(IsPremature==0))$diff_age_from_expected), digits=1)}'), 'wilcox',
   '1-3-6 Guidelines', glue('Meets: {round(mean((wg_elssp %>% filter(Meets136=="yes"))$diff_age_from_expected), digits=1)}; Does not meet: {round(mean((wg_elssp %>% filter(Meets136=="no"))$diff_age_from_expected), digits=1)}'), glue('Meets: {round(mean((ws_elssp %>% filter(Meets136=="yes"))$diff_age_from_expected), digits=1)}; Does not meet: {round(mean((ws_elssp %>% filter(Meets136=="no"))$diff_age_from_expected), digits=1)}'), 'wilcox',
  'Communication', glue('Spoken Language: {round(mean((wg_elssp %>% filter(Communication=="spoken"))$diff_age_from_expected), digits=1)}; Total Communication: {round(mean((wg_elssp %>% filter(Communication=="total communication"))$diff_age_from_expected), digits=1)}'),  glue('Spoken Language: {round(mean((ws_elssp %>% filter(Communication=="spoken"))$diff_age_from_expected), digits=1)}; Total Communication: {round(mean((ws_elssp %>% filter(Communication=="total communication"))$diff_age_from_expected), digits=1)}'),'wilcox',
  'Etiology', glue('SNHL: {round(mean((wg_elssp %>% filter(Etiology=="SNHL"))$diff_age_from_expected), digits=1)}; Mixed: {round(mean((wg_elssp %>% filter(Etiology=="Mixed"))$diff_age_from_expected), digits=1)}, Conductive: {round(mean((wg_elssp %>% filter(Etiology=="Conductive"))$diff_age_from_expected), digits=1)}'), glue('SNHL: {round(mean((ws_elssp %>% filter(Etiology=="SNHL"))$diff_age_from_expected), digits=1)}; Mixed: {round(mean((ws_elssp %>% filter(Etiology=="Mixed"))$diff_age_from_expected), digits=1)}, Conductive: {round(mean((ws_elssp %>% filter(Etiology=="Conductive"))$diff_age_from_expected), digits=1)}'),'kruskall',
  'Degree', glue('More severe: {round(mean((wg_elssp %>% filter(HLworse>64))$diff_age_from_expected), digits=1)}; Less severe: {round(mean((wg_elssp %>% filter(HLworse<64))$diff_age_from_expected), digits=1)}'),  glue('More severe: {round(mean((ws_elssp %>% filter(HLworse>56))$diff_age_from_expected), digits=1)}; Less severe: {round(mean((ws_elssp %>% filter(HLworse<56))$diff_age_from_expected), digits=1)}'),'wilcox',
   'Services Received Per Month', glue('More services: {round(mean((wg_elssp %>% filter(ServicesReceivedPerMonth>4))$diff_age_from_expected), digits=1)}; Less services: {round(mean((wg_elssp %>% filter(ServicesReceivedPerMonth<4))$diff_age_from_expected), digits=1)}'),  glue('More services: {round(mean((ws_elssp %>% filter(ServicesReceivedPerMonth>2))$diff_age_from_expected), digits=1)}; Less services: {round(mean((ws_elssp %>% filter(ServicesReceivedPerMonth<2))$diff_age_from_expected), digits=1)}'),'wilcox'
)

#currently doesn't include anything about whether it was sig
#maybe move each category to different row in cell
#also need to do something else for correlations - as is, not good

kable(delay_table,
      caption = "Delay table") %>%
  kable_styling(latex_options = "scale_down")

```

## Part III: Meets136 success
```{r 136-summary-stats}

perc_136_TD <- (nrow(elssp%>%filter(anycomorbid==0)%>%filter(Meets136=='yes'))/(nrow(elssp%>%filter(anycomorbid==0)%>%filter(Meets136=='yes'|Meets136=='no'))))*100
perc_136_DA <- (nrow(elssp%>%filter(anycomorbid==1)%>%filter(Meets136=='yes'))/(nrow(elssp%>%filter(anycomorbid==1)%>%filter(Meets136=='yes'|Meets136=='no'))))*100
```
Lastly, we looked at the ages at which children received diagnosis and intervention, and how this mapped onto the 1-3-6 guidelines. `r perc_136`% of our sample met 1-3-6 guidelines for early diagnosis and intervention. Of children with comorbidities (i.e., developmental concerns, prematurity, health issues, vision loss), only `r round(perc_136_DA, digits = 0)`% met 1-3-6 guidelines, compared to `r perc_136_TD`% of typically developing children. 


```{r meets136-timeline}
event <- c('Diagnosis','Intervention','Amplification', 'Implantation')
eventmin <- c(min(full_elssp$IdentificationOfHLMonths, na.rm = TRUE), min(full_elssp$AgeStartedServices, na.rm = TRUE), 
              min(full_elssp$AgeAmplification, na.rm = TRUE), min(full_elssp$AgeImplantation, na.rm = TRUE))
eventmax <- c(max(full_elssp$IdentificationOfHLMonths, na.rm = TRUE), max(full_elssp$AgeStartedServices, na.rm = TRUE), 
              max(full_elssp$AgeAmplification, na.rm = TRUE), max(full_elssp$AgeImplantation, na.rm = TRUE))
eventmean <- c(mean(full_elssp$IdentificationOfHLMonths, na.rm = TRUE), mean(full_elssp$AgeStartedServices, na.rm = TRUE), 
               mean(full_elssp$AgeAmplification, na.rm = TRUE), mean(full_elssp$AgeImplantation, na.rm = TRUE))
eventsd <- c(sd(full_elssp$IdentificationOfHLMonths, na.rm = TRUE), sd(full_elssp$AgeStartedServices, na.rm = TRUE), 
             sd(full_elssp$AgeAmplification, na.rm = TRUE), sd(full_elssp$AgeImplantation, na.rm = TRUE))
event_data <- data.frame(event, eventmin, eventmax, eventmean, eventsd)

ggplot(data = event_data, 
                    mapping = aes(x = reorder(event, eventmean), 
                                  y = eventmean, color=event)) + 
  geom_pointrange(mapping = aes(ymin = eventmean - eventsd,
                                ymax = eventmean + eventsd)) +
  geom_pointrange(mapping = aes(ymin = eventmin,
                                ymax = eventmax), width=2, alpha=0.5) +
  labs(x= "", y= "Age Months") + 
  coord_flip() +
  theme(legend.position = "none") +
  theme_classic() + labs(caption = "Figure XXX - Dots represent average age of diagnosis, etc. Stronger lines represent standard deviation. Softer lines show range.")

```

```{r lm-stats, include=F}

lm_pvalue <- function (modelobject) {
    if (class(modelobject) != "lm") stop("Not an object of class 'lm' ")
    f <- summary(modelobject)$fstatistic
    p <- pf(f[1],f[2],f[3],lower.tail=F)
    attributes(p) <- NULL
    return(p)
}

stepAIC(lm(IdentificationOfHLMonths ~ Gender + 
             Etiology +
             HLworse + 
             Laterality + 
             IsPremature + 
             HealthIssues + 
             DevelopmentalConcerns + 
             PrimaryLanguage + 
             VisionLoss + 
             ANSD, 
           (data=elssp %>% 
              filter(HLworse!="NA"))))
#Health issues , primary language

diagnosis_aic <- lm(formula = IdentificationOfHLMonths ~ HealthIssues + PrimaryLanguage, data = elssp)

stepAIC(lm(AgeStartedServices ~ Gender + 
             Etiology +
             HLworse + 
             Laterality + 
             HealthIssues + 
             IsPremature + 
             DevelopmentalConcerns + 
             Monolingual_English + 
             Communication + 
             VisionLoss + 
             ANSD + 
             IdentificationOfHLMonths +
             anycomorbid, 
           (data=full_elssp %>% filter(HLworse!="NA")))) 

services_aic <- lm(formula = AgeStartedServices ~ HLworse + IsPremature + 
                       IdentificationOfHLMonths, data = full_elssp)
```
We created linear regression models for age at diagnosis and age at intervention. Models were paired down using stepwise regression by AIC using the stepAIC function (cite MASS package). For age at diagnosis, we included the set of child-specific factors that would be relevant before diagnosis of hearing loss. We began with:
$$Age\:at\:Diagnosis \sim Gender + Degree\:of\:Hearing\:Loss\:(worse\:ear) + Developmental\:Delay + Health\:Issues + Prematurity + Laterality + Language \:Background + Etiology$$
Age diagnosis ~ gender + laterality + degree (worse ear) + developmental delay + health issues + prematurity + laterality + language background + etiology
The best fit model (R2=`r summary(diagnosis_aic)$r.squared` , p=`r lm_pvalue(diagnosis_aic)` )included health issues `r beta_output(diagnosis_aic, 2)` and language background `r beta_output(diagnosis_aic, 3)`.
$$Age\:at\:Diagnosis \sim Health\:Issues + Language\:Background$$

```{r diagnosis-betas}
dwplot(diagnosis_aic) + geom_vline(xintercept=0, linetype = 'dashed') + theme_classic()+ theme(legend.position="none")
options(repr.plot.width=6, repr.plot.height=4)
#caption: 
```


For age at intervention, we first included the variables potentially relevant prior to intervention: 
Age intervention ~ gender + degree (worse ear) + developmental delay + health issues + prematurity + laterality + language background + etiology + age diagnosis
$$Age\:at\:Intervention \sim Gender + Degree\:of\:Hearing\:Loss\:(worse\:ear) + Developmental\:Delay + Health\:Issues + Prematurity + Laterality + Language \:Background + Etiology +Age\:at\:Diagnosis$$
The best fit model (R2=`r summary(services_aic)$r.squared` , p=`r lm_pvalue(services_aic)`) included prematurity `r beta_output(services_aic, 3)`, degree of hearing loss `r beta_output(services_aic, 2)`, and age at diagnosis `r beta_output(services_aic, 4)`.
$$Age\:at\:Intervention \sim Degree\:of\:Hearing\:Loss\:(worse\:ear) + Prematurity + Age\:at\:Diagnosis$$

```{r intervention-betas}
dwplot(services_aic) + geom_vline(xintercept=0, linetype = 'dashed') + 
  theme_classic() + 
  theme(legend.position="none")
options(repr.plot.width=6, repr.plot.height=4)

#caption:  
```
# Discussion

# Conclusion





Footnotes: Despite exciting, increasing, and converging evidence for benefits of early sign language exposure [e.g., @schick2007; @spencer1993; @davidson2014; @magnuson2000; @clark2016; @hrastinski2016], the majority of DHH children will not be raised in a sign language environment. This is particularly true for North Carolina, which does not have a large community of sign language users, relative to states like Maryland or areas like Washington D.C. or Rochester, NY. For this reason, we focus on spoken language development. 

# References
