---
title             : "Characterizing North Carolina's Deaf/Hard-of-Hearing Infants and Toddlers: Predictors of Word Learning, Diagnosis, and Intervention"
shorttitle        : "ELSSP"


author: 
  - name          : "Erin Campbell"
    affiliation   : "1"
    corresponding : yes    
    email         : "erin.e.campbell@duke.edu"
    address       : "Address here"
  - name          : "Elika Bergelson"
    affiliation   : "1"

affiliation:
  - id            : "1"
    institution   : "Duke University"


keywords          : "keywords"
wordcount         : "X"

bibliography      : ["ELSSP.bib"]

floatsintext      : no
figurelist        : no
tablelist         : no
footnotelist      : no
linenumbers       : yes
mask              : no
draft             : no

documentclass     : "apa6"
classoption       : "man"
output            : papaja::apa6_pdf
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r load-packages, cache = FALSE, include = FALSE, echo=FALSE}
library(papaja) 
library(tidyverse)
library(knitr)
library(kableExtra)
library(citr)
library(readxl)
library(broom)
library(stargazer)
library(glue)
library(magick)
library(cowplot)
library(dotwhisker)
knitr::opts_chunk$set(fig.width=6, fig.height=6, comment=F, message=F, hide = T, warning = F, echo = F)
```

```{r read-in-data, echo = F, results = 'hide', message = F, comment = F, fig.show='hide'}
source('SM_functions.R')
source('functions_and_df_prep.R')
```

# Introduction
In the United States, 1-2 children are born with hearing loss, per 1,000 births [@cdc2018]. This translates to 114,000 Deaf or Hard of Hearing (DHH) children born in the U.S. per year [@martin2019]. Of these 114,000, ~90% will be born to hearing parents [@mitchell2004], in a home where spoken language is likely the dominant communication method. Depending on the type and degree of hearing loss and whether the child uses amplification, spoken linguistic input will be partially or totally inaccessible. Some of these children will develop spoken language within the range of their hearing peers [@verhaert2008; @geers2017], but many will face persistent spoken language deficits [@eisenberg2007; @moeller2007; @luckner2010; @sarchet2014], which may later affect reading ability [@kyle2010] and academic achievement [@qi2012; @karchmer2003]. 

Despite many excellent studies examining language development in DHH children, there is still a gap in the literature describing and analyzing spoken language development across the full range of children receiving state services for hearing loss, with many studies focusing in on specific subgroups (e.g. children under age X with Y level of hearing loss and Z amplification approach, e.g. @vohr2008; @yoshinaga-itano2018). In what follows, we first summarize the previous literature on predictors of spoken language outcomes in DHH children. We then provide  a brief overview of a common vocabulary measure used in the current study, the MacArthur-Bates Communicative Development Inventory (CDI). Finally, we turn to an empirical analysis of  early vocabulary in a wide range of young children receiving state services in North Carolina. We have two broad goals in what follows. First, we aim to provide a comprehensive description of a heterogeneous group of young children who receive state services for hearing loss. Second, we aim to connect the intervention approaches and child characteristics of this sample with children’s vocabulary, with the broader goal of considering the success of early diagnosis and intervention initiatives. 

## Predictors of Language Outcomes
Though the literature points towards spoken language delays and deficits for DHH children, this is a highly variable population with highly variable outcomes [@pisoni2018]. Previous research indicates that gender [@kiese-himmel2002a; @ching2013], additional disability [@ching2013; @yoshinaga-itano2017; @verhaert2008], degree and configuration of hearing loss [@ching2013; @dediego-lazaro2018; @vohr2011; @yoshinaga-itano2017], amplification [@walker2015], communication [@geers2017], and early diagnosis/intervention [@yoshinaga-itano2017; @yoshinaga-itano2018] predict language outcomes in DHH children. We first provide a brief literature review on the effect of these predictors on language skills in DHH children.

### Gender
For hearing children, the literature points to a female gender advantage in early language acquisition. Girls speak their first word earlier [@macoby1966], have a larger [@bornstein2004; @fenson1994; @frank2017] and faster-growing vocabulary [@huttenlocher1991], and stronger grammatical and phonological skills [@lange2016; @ozcaliskan2010]. This finding appears to be consistent across studies [@wallentin2009], various spoken languages [@frank2019], and gesture [@ozcaliskan2010]. 

The DHH literature presents a more mixed (though rather understudied) picture. On one hand, DHH girls,  like hearing girls, have been found to have a larger spoken vocabulary than DHH boys [@kiese-himmel2002a; @ching2013]. However, in contrast to their hearing peers, DHH children do not seem to show a gender-based difference for some aspects of syntactic development [@pahlavannezhad2014].

### Comorbidities
Additional co-occuring disabilities occur frequently in the DHH population, perhaps as much as three times more than in the hearing population [@pollack1997]. Incidence estimates for co-occurring disabilities in DHH children range from 25-51% [@bruce2015; @guardino2008; @luckner2001; @picard2004; @schildroth1996; @soukup2007; @holden-pitt1998], with approximately 8% of DHH children living with 2 or more co-occurring disabilities [@schildroth1996]. 

Some of these conditions, particularly those which carry risk of developmental delay (e.g., Down syndrome), result in language delays independent of hearing loss [@chapman1997; @kristoffersen2008; @weismer2010]. These effects vary by the nature of the specific disability [@cupples2018; @cupples2014], with cognitive ability more predictive of language outcomes than presence or absence of additional disability [@meinzen-derr2011; @sarant2008]. Disability and hearing loss likely each contribute to a given child’s spoken language development [@rajput2003; @vannierop2016; @ching2013], with differential effects of each [@vesseur2016]. In some cases, additional disabilities appear to interact with hearing loss to intensify developmental delays [@birman2012; @pierson2007].

Furthermore, incidence of hearing loss is higher among children born premature (defined as < 37 weeks gestational age). Compared to an incidence of 0.2% in full-term infants, incidence of hearing loss in extremely premature infants (defined as < 33 weeks gestational age) ranges 2--11%, with increased prematurity associated with increased rates of hearing loss [@wroblewska-seniuk2017]. 

Independently of hearing status, prematurity is linked to increased risk of language delay and disorder [@rechia2016; @vannoort-vanderspek2012; @carter2017; @vohr2014; @cusson2003; @barre2011]. Unfortunately, research on language development in premature DHH children is scant [@vohr2016], so it remains unclear how hearing loss and prematurity may interact within spoken language skills. One study of premature infants finds that auditory brainstem response during newborn hearing screening predicts language performance on the PLS-4 at age 3 [@amin2014], suggesting a link between prematurity, hearing loss, and language development in early childhood, though further research is needed in this domain. In extremely premature DHH children, incidence of additional disabilities may be as high as 73% [@robertson2009]. Indeed, pre-term infants with comorbidities have been found to be more likely to also have hearing loss than those without comorbidities [@schmidt2003], further complicating language development for this population.

### Audiological Characteristics
Hearing loss varies in severity, ranging from slight to profound [@clark1981]. More severe hearing loss (less access to spoken language) typically results in more difficulty with spoken language in infancy [@vohr2008], early childhood [@ching2010; @ching2013; @tomblin2015; @sarant2008; @sininger2010] and school-age children [@wake2004]. Although profound hearing loss is associated with more pronounced spoken language difficulty, even mild to moderate hearing loss is associated with elevated risk of language disorders [@delage2007; @blair1985].

Hearing loss also varies in whether it affects one ear or both. Bilateral hearing assists speech perception, sound localization, and loudness perception in quiet and noisy environments [@ching2007]. The literature on hearing aids and cochlear implants also points to benefits for bilateral auditory input [@sarant2014; @lovett2010; @smulders2016]. At school-age, 3--6% of children have unilateral hearing loss [@ross2010]. Although children with unilateral hearing loss have one “good ear,” even mild unilateral hearing loss has been tied to higher risk of language delays and educational challenges relative to hearing children [@vila2015; @lieu2013; @lieu2004; @lieu2012; @kiese-himmel2002]. Just as in the bilateral case, more severe hearing loss leads to greater deficits in language and educational outcomes for children with unilateral hearing loss [@lieu2013;@anne2017]. 

Many DHH children receive hearing aids (HAs) or cochlear implants (CIs) to boost access to the aural world. These devices have been associated with better speech perception and spoken language outcomes [@walker2015; @waltzman1997; @niparko2010]. In turn, aided audibility predicts lexical abilities with children in HAs [@stiles2012]. 

For both hearing aids and cochlear implants, earlier fit leads to better spoken language skills, if the amplification is effective. For hearing aids, some studies find that children with milder hearing loss who receive hearing aids earlier have better early language achievement than children who are fit with hearing aids later [@tomblin2015], but this finding does not hold for children with severe to profound hearing loss [@kiese-himmel2002; @watkin2007] (for whom hearing aids are generally ineffective). Analogously, children who are eligible and receive cochlear implants earlier have better speech perception and spoken language outcomes than those implanted later [@dettman2007; @miyamoto2008; @svirsky2004; @yoshinaga-itano2018; @artieres2009], with best outcomes for children receiving implants before their first birthday [@dettman2007]. 

### Communication
Total Communication (TC) refers to communication that combines speech, gesture, and elements of sign, sometimes simultaneously.  Total communication, while it often includes elements of sign, such as individual signs, is not a sign language, such as American Sign Language. Clinicians currently employ TC as an alternative or augmentative communication method for children with a wide range of disabilities [@branson2009; @gibbs1991; @mirenda2003].

Compared to total communication, DHH children using an exclusively oral approach have better speech intelligibility [@geers2017; @dillon2004; @geers2002; @hodges1999] and auditory perception [@geers2017; @odonoghue2000]. That said, there is some debate as to whether an oral approach facilitates higher spoken language performance, or whether children who demonstrate aptitude for spoken language are steered towards the oral approach rather than TC [@hall2017].

### 1-3-6 Guidelines
Early identification [@yoshinaga-itano2018; @yoshinaga-itano1998; @white1987; @robinshaw1995; @apuzzo1995; @kennedy2006] and timely enrollment in early intervention programs [@vohr2008; @watkin2007; @ching2013; @holzinger2011; @vohr2011] are associated with better language proficiency. Indeed, DHH children who receive prompt diagnosis and early access to services have been found to meet age-appropriate developmental outcomes, including language [@stika2015]. 

In line with these findings, the American Academy of Pediatricians (AAP) has set an initiative for Early Hearing Detection and Intervention (EHDI). Their EHDI guidelines recommend that DHH children are screened by 1 month old, diagnosed by 3 months old, and enter early intervention services by 6 months old. We refer to this guideline as 1-3-6. Meeting this standard appears to improve spoken language outcomes for children with HL [@yoshinaga-itano2017; @yoshinaga-itano2018] and the benefits appear consistent across a range of demographic characteristics. 

At a federal level in the U.S., the Early Hearing Detection and Intervention Act of 2010 [@capps2009] was passed to develop state-wide systems for screening, evaluation, diagnosis, and “appropriate education, audiological, medical interventions for children identified with hearing loss,” but policies for early diagnosis and intervention vary by state.  As of 2011, 36 states (including North Carolina, @2000] mandate universal newborn hearing screening [@nationalconferenceofstatelegislatures2011]. All states have some form of  early intervention programs that children with hearing loss can access [@nad], but these also vary state-by-state. For instance, half of the states in the US do not consider mild hearing loss an eligibility criterion for early intervention [@holstrum2008].

In evaluating the success of this initiative, the AAP [@ehdi] finds that about 70% of US children who fail their newborn hearing screening test are diagnosed with hearing loss before 3 months old, and that 67% of those diagnosed (46% of those that fail newborn hearing screening) begin early intervention services by 6 months old. These findings suggest that there may be breaks in the chain from screening to diagnosis and from diagnosis to intervention, and the effect may be further delays in language development for children not meeting these guidelines.
 
## Quantifying vocabulary growth in DHH children
The MacArthur Bates Communicative Development Inventory [CDI, @fenson1994] is a parent-report instrument that gathers information about children’s vocabulary development. The Words and Gestures version of the form (CDI-WG) is normed for 8--18-month-olds. On CDI-WG, parents indicate whether their child understands or produces each of the 398 vocabulary items, and answer questions about young children’s early communicative milestones.  The Words and Sentences version of the form (CDI-WS) is normed for 16-30-month-olds. On CDI-WS, parents indicate whether their child produces each of the 680 vocabulary items, and answer some questions about grammatical development. The CDI has been normed on a large set of participants across many languages [@anderson2002; @frank2017; @jackson-maldonado2003]. 

The CDI has also been validated for DHH children with cochlear implants [@thal2007]. More specifically, in this validation, researchers asked parents to complete the CDI, administered the Reynell Developmental Language Scales, and collected a spontaneous speech sample. All comparisons between the CDI and the other measures yielded significant correlations ranging from 0.58 to 0.93. Critically, the children in this study were above the normed age range for the CDI, and thus this validation helps to confirm that the CDI is a valid measurement tool for older DHH children. In further work, @castellanos2016 finds that in children with CIs, number of words produced on the CDI predicts language, executive function, and academic skills up to 16 years later. Building on this work, several studies have used the CDI to measure vocabulary development in DHH children (@ching2013; @yoshinaga-itano2017; @yoshinaga-itano2018; @dediego-lazaro2018; @vohr2008; @vohr2011; summarized in \@ref(tab:CDIsummary)). 


```{r CDIsummary}

research_table <- tribble(
  ~Study, ~Population,  ~Gender, ~'1-3-6', ~Laterality, ~Degree, ~Amplification, ~Communication, ~Comorbidities,
  "Ching et al., 2013", "3 year old children receiving services in Australia", "Female +", "Did not study", "Did not study", "More severe -", "No effect", "No effect", "Comorbidities -",
  "Yoshinaga-Itano et al., 2017", "8-39 month children with bilateral hearing loss", "No effect", "1-3-6 +", "Did not study", "More severe -", "Did not study", "Did not study", "Comorbidities -",
  "Yoshinaga-Itano et al., 2018", "Children with cochlear implants", "Did not study", "1-3-6 +", "Did not study", "Did not study", "Earlier CI activation +", "Did not study", "Did not study",
  "De Diego-Lazaro et al., 2018", "Spanish speaking children with bilateral hearing loss", "No effect", "Earlier intervention +", "Did not study", "Milder +", "More functional hearing +", "Did not study", "Did not study",
  "Vohr et al., 2011", "18-24 month olds with hearing loss", "Did not study", "Earlier intervention +", "Did not study", "Milder +", "Did not study", "Did not study", "NICU stay -; Comorbidities -"
)

kable(research_table,
      caption = "Summary of findings of CDI studies in DHH children") %>%
  kable_styling(latex_options = c("scale_down")) %>%
  add_footnote("+ equals bigger vocab, - equals smaller vocab")



```

## Goals and Predictions
This study aims to 1) characterize the demographic, audiological, and intervention variability in the population of DHH children receiving state services for hearing loss; 2) identify predictors of vocabulary delays; and 3) evaluate the success of early identification and intervention efforts at a state level. We include three subgroups of DHH children traditionally excluded from studies of language development: children with additional disabilities, children with unilateral hearing loss, and children from bilingual or non-English-speaking households [e.g., @yoshinaga-itano2018]. 

For the first and third goal above, we did not have specific hypotheses and sought to provide descriptive information about a diverse sample of DHH children receiving state services. For the second, we hypothesized that male gender, more severe degree of hearing loss,  bilateral hearing loss, no amplification use, prematurity, and presence of additional disabilities would predict larger spoken vocabulary delay. We did not have strong predictions regarding the effects of communication method or presence of other health issues (e.g., congenital heart malformation) on vocabulary.
<!-- eb: for the first goal, that's not quite true, see my note in results part 1 -->

# Methods
``` {r demo-data}
num_subs <- nrow(elssp)
num_repeat_subs <- nrow(elssp %>% filter(as.numeric(VisitTotal) > 1)) 
num_girls <- nrow(elssp %>% filter(Gender == 'female'))
num_boys <- nrow(elssp %>% filter(Gender == 'male'))
min_age <- min(elssp$Age)
max_age <- max(elssp$Age)
mean_age <- mean(elssp$Age)
sd_age <- sd(elssp$Age)
num_too_old_wg <- nrow(elssp_datasets[[1]]$elssp_df %>% filter(Age>18))
num_spanish_cdi <- nrow(elssp %>% filter(PrimaryLanguage == 'Spanish'))
```

Clinical evaluations were obtained through an ongoing collaboration with  the North Carolina Early Language Sensory Support Program (ELSSP), an early intervention program serving children with sensory impairments from birth to 36 months. ELSSP passed along deidentified evaluations to our team after obtaining consent to do so from each family. No eligibility criteria beyond hearing loss and receiving an ELSSP evaluation were imposed, given our goal of characterizing the full range of DHH children with hearing loss in North Carolina.

The clinical evaluations included demographic and audiological information, CDI vocabulary scores, and the results of any clinical assessments administered (e.g., PPVT), all detailed further below. For some children (n=`r num_repeat_subs`), multiple evaluations were available from different timepoints. In these cases, only the first evaluation was considered for this study, due to concerns regarding within-subjects variance for statistical analysis.

While this collaboration is ongoing, we opted to pause for this analysis upon receiving data from 100 children. Thus, the reported sample below consists of `r num_subs` children (`r num_boys` male / `r num_girls` female) ages `r min_age`--`r max_age`(M=`r mean_age`, SD=`r sd_age`). Race and SES information were not available. Families were administered either the WG or WS version of the CDI based on clinician judgement. Children who were too old for WG, but who were not producing many words at the time of assessment, were often given WG (n=`r num_too_old_wg`). Families for whom Spanish was the primary language (n=`r num_spanish_cdi`) completed the Spanish language version of the CDI [@jackson-maldonado2003].
<!-- eb: always use as few abbreviations as possible, i'd write out WG and WS each time -->

```{r CDIinfo, echo=FALSE}

tribble(
  ~'CDI version', ~'Average Age (SD)',  ~'Average Comprehension (SD)', ~'Average Production (SD)', ~'% Developmental Delays',
  glue('WG (n={nrow(elssp_datasets[[1]]$elssp_df)})'), glue('{round(mean(elssp_datasets[[1]]$elssp_df$Age), digits=2)} ({round(sd(elssp_datasets[[1]]$elssp_df$Age), digits=2)}) months'), glue('{round(mean(elssp_datasets[[1]]$elssp_df$ComprehensionCDI, na.rm = TRUE), digits=0)} ({round(sd(elssp_datasets[[1]]$elssp_df$ComprehensionCDI, na.rm = TRUE), digits=1)}) words'), glue('{round(mean(elssp_datasets[[1]]$elssp_df$ProductionCDI, na.rm = TRUE), digits=0)} ({round(sd(elssp_datasets[[1]]$elssp_df$ProductionCDI, na.rm = TRUE),digits=1)}) words'), glue('{round(((nrow(elssp_datasets[[1]]$elssp_df %>% filter(DevelopmentalConcerns=="yes")))/(nrow(elssp_datasets[[1]]$elssp_df)))*100, digits=2)}%'),
  glue('WS (n={nrow(elssp_datasets[[2]]$elssp_df)})'), glue('{round(mean(elssp_datasets[[2]]$elssp_df$Age), digits=2)} ({round( sd(elssp_datasets[[2]]$elssp_df$Age), digits=2)}) months'), 'NA', glue('{round(mean(elssp_datasets[[2]]$elssp_df$ProductionCDI, na.rm = TRUE), digits=0)} ({round(sd(elssp_datasets[[2]]$elssp_df$ProductionCDI, na.rm = TRUE), digits=1)}) words'), glue('{round(((nrow(elssp_datasets[[2]]$elssp_df %>% filter(DevelopmentalConcerns=="yes")))/(nrow(elssp_datasets[[2]]$elssp_df)))*100, digits=2)}%')) %>%
kable(caption = "CDI details") %>%
  kable_styling(latex_options = c("scale_down"))

```

With regard to comorbid diagnoses, children in this sample were coded as yes/no for cognitive development concerns (e.g., Down syndrome, global developmental delays; Cornelia de Lange syndrome), yes/no for prematurity (i.e., more than 3 weeks premature), yes/no for health issues (e.g., heart defects, kidney malformations, VACTERL association), and yes/no for vision loss (not corrected to normal by surgery or glasses). 

```{r comorbid-info}
perc_prem_NICU <- (nrow(comorbid%>%filter(NICU==1&IsPremature==1))/(nrow(elssp %>% filter(IsPremature==1))))*100

comorbid_table <- tribble(
  ~Condition, ~'Specific Condition',  ~n,
  "Premature", "", n_condition(IsPremature),
  "", "Extremely Premature", n_condition(extremelypremature),
  "", "NICU stay", n_condition(NICU),
  "Health Issues", "", n_condition(HealthIssues),
  "", "Heart", n_condition(heart_issues),
  "", "Lung", n_condition(lung_issues),
  "", "Illness", n_condition(illness),
  "", "Feeding Issues", n_condition(feeding_issues),
  "", "Pregnancy/Birth Complications", n_condition(preg_birth_comp),
  "", "Musculoskeletal", n_condition(mus_skel),
  "", "Cleft Lip/Palate", n_condition(cleft),
  "", "Other", n_condition(health_issues_other),
  "Developmental Concerns", "",  n_condition(DevelopmentalConcerns),
  "", "Down Syndrome", n_condition(downsyndrome),
  "", "Chromosomal Issues", n_condition(otherchromissues),
  "", "Neural Tube Defects", sum(n_condition(encephalocelecyst), n_condition(occipitalencephalocele)),
  "", "Other", sum(n_condition(agenesiscorpuscallosum), n_condition(oculomotorapraxia), n_condition(ventricular_issues), n_condition(corticalvisualimpairment), n_condition(hydrocephalus), n_condition(overalldevconcerns), n_condition(corneliadelange)),
  "Vision Loss", "",  n_condition(VisionLoss),
  "", "Retinopathy of Prematurity",  n_condition(RetinopathyOfPrematurity),
  "", "Nearsightedness",  n_condition(myopia),
  "", "Farsightedness",  n_condition(hyperopia),
  "", "Cortical Visual Impairment",  n_condition(corticalvisualimpairment)
)


kable(comorbid_table, longtable=T,
      caption = glue::glue("Additional Diagnoses (n={n_condition(anycomorbid)})")) %>%
  kable_styling(latex_options = "hold_position") %>%
  add_footnote("N.B. ns do not sum to total because many participants had multiple diagnoses")

```

Degree of hearing loss was most often reported with a written description (e.g., “mild sloping to moderate” or “profound high frequency loss”). We created 3 variables: hearing loss in the better ear, hearing loss in the worse ear, and average hearing loss (average of better and worse ear). Using the ASHA hearing loss guidelines, each of these was coded with a dB HL value corresponding with the median dB HL for the level of hearing loss (e.g., moderate hearing loss was coded as 48 dB HL), and sloping hearing loss was coded as the average of the levels (e.g. mild to moderate was coded as 40.5 dB HL). Participants were also coded for unilateral or bilateral hearing loss; presence or absence of Auditory Neuropathy Spectrum Disorder; and etiology of hearing loss (sensorineural, conditive, or mixed). Amplification was recorded as the device the child used at the time of assessment: either hearing aid, cochlear implant, or none.

```{r amp-info}
elssp %>% 
  filter(Amplification != '', Laterality != '') %>%
  dplyr::select(VIHI_ID, AgeImplantation, AgeAmplification, HLbetter, HLworse, Laterality, Amplification) %>%
  group_by(Laterality, Amplification) %>%
  dplyr::summarise(mean_HLbetter = round(mean(HLbetter, na.rm = TRUE), 2),
                   mean_HLworse = round(mean(HLworse, na.rm = TRUE), 2),
                   mean_age_amplification = round(mean(AgeAmplification, na.rm = TRUE), 2),
                   mean_age_implantation = round(mean(AgeImplantation, na.rm = TRUE), 2)) %>% 
  kable(caption = glue::glue("Audiological Characteristics of the Sample")) %>%
  kable_styling(latex_options = c("hold_position", "scale_down")) 
```

Communication method was recorded as spoken language, total communication, or cued speech. One participant had a parent fluent in sign language, but the reported communication method in the home was total communication. No child in our sample used American Sign Language or another signed language. The forms also listed the primary language spoken at home. Families in this sample either spoke English or Spanish. For one child, who was adopted from India at 28 months, we recorded the primary language as Hindi, although the child's adoptive parents are English-speaking, because the child had lived most of her life in a non-English-speaking environment.
<!-- eb: i think we talked about dropping this participant, but if we don't, we may want to make the preceding sentence slightly more anonymizing, given that we're going to be sharing the data. we can talk about this. -->
```{r comm-info}
kable((language_stats <- elssp %>% 
  filter(PrimaryLanguage != '', Communication != '') %>%
  dplyr::select(VIHI_ID, Communication, PrimaryLanguage) %>%
  group_by(Communication, PrimaryLanguage) %>%
  dplyr::count(name = 'Tally') %>%
  pivot_wider(names_from = PrimaryLanguage, values_from = Tally) %>%
  replace_na(list(English=0, Hindi=0, Spanish=0)) %>%
  mutate(Total = English + Hindi + Spanish)),
      caption = "Language and communication characteristics of the sample") %>%
  kable_styling(latex_options = "hold_position")
```


Age at screening was measured as the child’s age in months at their first hearing screening. Age at screening was available for `r nrow(elssp %>% filter(NBHS=='Y'))` participants. All participants with a screening age available were screened at birth or while in the NICU. We presume that the vast majority of participants without age at screening received their newborn hearing screening, as North Carolina boasts a 98% NBHS rate [@ncdhhs2013]. Age at diagnosis was taken as the age in months when children received their first hearing loss diagnosis. All children were enrolled in birth-to-three early intervention services through ELSSP, and the date of enrollment was listed on the clinician evaluation. From the clinician report, we calculated the number of hours of early intervention services received per month (including service coordination, speech therapy, and occupational therapy, among others). 
Because of the relatively sparse data on screening age, if participants had an age at diagnosis  $\leq$ 3 mo. and an age of intervention  $\leq$ 6 mo., they were recorded as meeting 1-3-6. It is possible that a participant did not receive screening by 1 month, but did receive diagnosis by 3 months and services by 6 months. This special case would be coded as meeting 1-3-6 by our criteria.

```{r meets136-info}
kable(tribble(
  ~'', ~'', 
'Diagnosis by 3 months', glue('{round((nrow(elssp%>%filter(meets13=="yes"))/(nrow(elssp %>% filter(meets13=="yes"|meets13=="no"))))*100,2)}%'),

'Average Age Diagnosis (SD)', glue('{round(mean(elssp$IdentificationOfHLMonths, na.rm = TRUE), digits=2)} ({round(sd(elssp$IdentificationOfHLMonths, na.rm = TRUE), digits=2)}) months'),
'Intervention by 6 months', glue('{round((nrow(elssp%>%filter(meets6=="yes"))/(nrow(elssp %>% filter(meets6=="yes"|meets6=="no"))))*100,2)}%'),

'Average Age Intervention (SD)', glue('{round(mean(elssp$AgeStartedServices, na.rm = TRUE), digits=2)} ({round(sd(elssp$AgeStartedServices, na.rm = TRUE), digits=2)}) months'),

'Meets 1-3-6', glue('{round((nrow(elssp%>%filter(Meets136=="yes"))/(nrow(elssp %>% filter(Meets136=="yes"|Meets136=="no"))))*100,2)}%')
),
      caption = "Meets 1-3-6 table") %>%
  kable_styling(latex_options = c("hold_position")) 
```

```{r variables-list}
tribble(
  ~Variable, ~Scale, ~ Range, 
'Age', 'Continuous', glue('{min(elssp$Age)}-{round(max(elssp$Age), digits=0)} months'),
'Age at Amplification', 'Continuous', glue('{min(elssp$AgeAmplification, na.rm=TRUE)}-{max(elssp$AgeAmplification, na.rm=TRUE)} months'),
'Age at Diagnosis', 'Continuous', glue('{min(elssp$IdentificationOfHLMonths, na.rm=TRUE)}-{max(elssp$IdentificationOfHLMonths, na.rm=TRUE)} months'),
'Age at Implantation', 'Continuous', glue('{min(elssp$AgeImplantation, na.rm=TRUE)}-{max(elssp$AgeImplantation, na.rm=TRUE)} months'),
'Age at Intervention', 'Continuous', glue('{min(elssp$AgeStartedServices, na.rm=TRUE)}-{max(elssp$AgeStartedServices, na.rm=TRUE)} months'),
'Amplification', 'Categorical', 'Hearing Aid / Cochlear Implant / None',
'Communication', 'Categorical', 'Spoken / Total Communication / Cued Speech',
'Degree Hearing Loss (worse ear)', 'Continuous', glue('{min(elssp$HLworse, na.rm=TRUE)}-{max(elssp$HLworse, na.rm=TRUE)} dB HL'),
'Developmental Delay', 'Categorical', 'Yes / No',
'Gender', 'Categorical', 'Female / Male',
'Health Issues', 'Categorical', 'Yes / No',
'Language in Home', 'Categorical', 'English / Other',
'Laterality', 'Categorical', 'Unilateral / Bilateral',
'Meets 1-3-6', 'Categorical', 'Yes / No',
'Prematurity', 'Categorical', 'Full-term / Premature',
'Services Received Per Month', 'Continuous', glue('{min(elssp$ServicesReceivedPerMonth, na.rm=TRUE)}-{max(elssp$ServicesReceivedPerMonth, na.rm=TRUE)} services per month'),
'Type of Hearing Loss', 'Categorical', 'Sensorineural / Conductive / Mixed',
'CDI - Words Produced', 'Continuous', glue('{min(elssp$ProductionCDI, na.rm=TRUE)}-{max(elssp$ProductionCDI, na.rm=TRUE)} words'),
) %>% kable(caption = "Variables table") %>%
  kable_styling(latex_options = "scale_down") 
```

# Results
In the first section, we explore relationships among child demographic, audiological, and clinical variables. In the second section, we examine the influence of these factors on vocabulary development. In the third section, we describe the implementation of the EHDI 1-3-6 guidelines and predictors of early diagnosis and intervention. All analyses were conducted in R. All code is available on Github. 
<!-- eb: you can put it on a public github repo but you should also make an OSF page for this paper, and refer to that in the paper, since github isn't archival in the same way -->

## Part I: Interactions Among Variables

<!-- eb: so chi square only makes sense if the null hypothesis is that the two variables are unrelated, and generally assumes n=5 expected as a minimum in each cell, which isn't the case for lots of these comparisons. Prematurity and health issues are not unrelated. Laterality and amplification are not unrelated. Etiology & laterality: isn't it impossible to be 'mixed' for unilateral?...etc. there are others. 
And i'm pretty sure it's not okay to run a chisquare if the expected value in any cell is 0
cf https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3900058/ so you'd have to take some comparisons off the table

i'm not sure this is the right approach, but keeping it for now.

I'm doing some editing below to clarify some of this.
i'm not sure we want to keep any of the bubble plots, ; i don't think they add that much beyond the text, especially for the non-hearing relevant ones. If they make it easiser for you to write the text for the results of the chisquareds, you could keep them in a supplementary materials separate rmd if you want. 
for the  main paper, why don't you instead make the following two graphs:
1) a bar graph with HL worst on the x axis and  dodged bars by color for amp, and the counts of the number of kids on the y-axis
2) a bar graph with etiology on the x axis, and dodged bars for laterality, and within the bars stack color for each amplification
that would get lots of info across more succinctly, and then drop all the bubble plots

* something looks off about your SPM variable: it's showing up in the wrong order on your graph and so probably isn't correctly ordered if it ever shows up in your models
-->

Before we test how these variables may be related to vocabulary, we describe their relationships to each other. As would be expected, many health, audiological, and clinical characteristics are not distributed randomly across this sample of children. To quantify this statistically, we used bonferroni-corrected chi-square tests between each of our variables (gender (male/female), laterality (bi-/uni-lateral hearing loss), health issues (yes/no), developmental delays (yes/no), prematurity (yes/no), language background (english/non-english), 1-3-6 (yes/no), degree of hearing loss (mild, moderate, severe/profound as defined above), etiology(sensorineural, mixed, conductive), services received per month (binned into 0-3, 4-10, and >10), communication (spoken/other (i.e. total communication or cued speech) and amplification (hearing aids, cochlear implants, none). Strictly speaking, some of these variables are not expected to be randomly distributed relative to each other, but quantifying the differences via chi square using a conservative significance threshold lets us highlight the strongest relationships within this dataset.
<!-- eb: you have to provide some sort of justification for the binning of # of services per month that way, is that create 3 even bins for instance?. i'd also suggest adding mean(SD) and range to your table 7 instead of just range. 
as the article i linked to above suggests, you want n of 5 for 80% of your cells, so if there are cases where that's not true you should either not run the test on that combo, or group things together that have low n (e.g. lang background: english/non-english, communication: spoken/not (combine TC & cued))
-->


<!-- eb: fix XX  & following #s in next sentence after addressing comments above -->
Given that we ran XX Chi-square tests, Bonferroni-corrected alpha for this set of analyses was p < 0.0007. Of these `r nrow(chi_sq_all)` combinations of variables, p < .05 for `r nrow(chi_sq_all %>% filter(p.value<.05))`, and `r nrow(chi_sq_all %>% filter(p.value<.000757))` survived Bonferroni correction. We are only discussing the latter below, but the full set of results can be found in figure \@ref(fig:relationships-plot).


```{r relationships-plot, fig.width=12, fig.height=9.5}
#I wasn't ready to completely get rid of the correlation matrix, but I prefer the chi square stuff.
# eb: i don't think a correlation matrix with chi square results makes sense

# corrplot(elssp_corr, method = 'color', p.mat = p_corr$p,
#          type = "upper",
#          order = "hclust", tl.cex=1,
#          tl.col = "black", addCoef.col = "black",
#          sig.level = 0.001, insig = "blank", diag = FALSE)

ggplot(chi_sq_all, aes(y=Var2, x=Var1)) +
  geom_tile(aes(fill = sig)) + theme_classic() +
  theme(axis.text.x = element_text(angle = 90, hjust=0.90,vjust=0.2), 
        axis.text = element_text(size=16),
        legend.text = element_text(size=16)) +
  scale_fill_brewer(palette = "RdPu", direction=-1) +
  geom_text(aes(label=ifelse(sig=='survives bonferroni correction', round(eff.size,2), '')), 
            size=5) +
  xlab(NULL) + ylab(NULL) +
  labs(caption = "Results of chi-square tests between variables.\nFor tests that survived bonferroni correction,\neffect size (Cramer's V) is given.")
```

We found that health issues, developmental delays, and prematurity were highly interrelated in our sample, such that children born premature were more likely to also experience health issues `r chisq_output("IsPremature","HealthIssues")` and developmental delays `r chisq_output("IsPremature","DevelopmentalConcerns")`, and children with developmental delays were more likely to also experience health issues `r chisq_output("DevelopmentalConcerns","HealthIssues")`. Children with developmental delays received more services per month than typically-developing children `r chisq_output("DevelopmentalConcerns", "SPM_cat")` and were more likely to use total communication `r chisq_output("DevelopmentalConcerns","Communication")`. Likewise, children who used total communication received more services per month than children using spoken language `r chisq_output("Communication", "SPM_cat")`.

We also found relationships among many of the audiological characteristics. There was a significant relationship between laterality and etiology `r chisq_output("Laterality","Etiology")`, such that children with conductive hearing loss were more likely to have unilateral hearing loss, children with sensorineural hearing loss were more likely to have a bilateral loss, and all children with mixed hearing loss (n = `r nrow(elssp %>% filter(Etiology=='Mixed'))`) had bilateral hearing loss. Chi-square tests showed that laterality `r chisq_output("Laterality","Amplification")` and degree of hearing loss `r chisq_output("HLworse_cat", "Amplification")` were related to amplification in our sample. Children with bilateral hearing loss were more likely than children with unilateral hearing loss to use a hearing aid or cochlear implant; no child with unilateral hearing loss used a cochlear implant, and many children with unilateral hearing loss used no amplification. Regarding degree, children with severe-profound hearing loss were more likely to use a cochlear implant than children with less severe hearing loss (i.e., mild or moderate).
<!-- eb: see note about about etiology -->

```{r balloon-plots}
#I think the gg ones are prettier, but the nz ones are maybe more informative. Can't make up my mind
# eb: oh i definitely like the nz ones better, but see above, not sure we want to keep them in main text
# nz_balloons("Laterality", "Amplification")
# nz_balloons("Laterality", "Etiology")
# nz_balloons("HLworse_cat", "Amplification")
# nz_balloons("DevelopmentalConcerns", "SPM_cat")
# nz_balloons("DevelopmentalConcerns", "Communication")
# nz_balloons("DevelopmentalConcerns", "IsPremature")
# nz_balloons("HealthIssues", "DevelopmentalConcerns")
# nz_balloons("HealthIssues", "IsPremature")

gg_balloons("Laterality", "Amplification")
gg_balloons("Laterality", "Etiology")
gg_balloons("HLworse_cat", "Amplification")
gg_balloons("DevelopmentalConcerns", "SPM_cat")
gg_balloons("DevelopmentalConcerns", "Communication")
gg_balloons("DevelopmentalConcerns", "IsPremature")
gg_balloons("HealthIssues", "DevelopmentalConcerns")
gg_balloons("HealthIssues", "IsPremature")
```

## Part II: Influence on vocabulary



We next turn to the relationship between each of these variables and children’s productive vocabulary, measured on the CDI. Figure \@ref(fig:wg-ws-rainbow-plot) shows the vocabulary scores of children in our samples relative to norms for hearing children. Descriptively, we found widespread vocabulary delays on both Words and Gestures and Words and Sentences, with the majority of DHH children testing around or below the 25th percentile for hearing children. 
<!-- eb: 25%ile based on... -->

The CDI is composed of two instruments, which are typically given to different age groups, but in this sample, are administered based on clinician assessment of the child’s language ability. The two instruments differ in number of questions; the max score is 398 on Words and Gestures and 680 on Words and Sentences. For this reason, instead of using the raw number of words produced as our outcome variable, we use the difference (in months) between the child’s chronological age and their predicted age for their vocabulary -- we call this derived variable **vocabulary delay**. 
<!-- eb: remove redundancy between para above and methods about # items in CDI and how it was decided which kid got which. since CDI is your main instriument you want to describe it in methods and here just remind the reader that they had different #s of items -->


To predict age from vocabulary score, we used the 50th percentile for productive vocabulary from Wordbank data from (8,300 typically-developing infants; @frank2017) to create a binary logistic growth curve. The growth curve modeled the 50th percentile language trajectories for WG-CDI and WS-CDI. For each child, we took the number of words they produced divided by the number of words on the instrument, to give us the proportion of words produced. We used the proportion of words in an inverse prediction from the binary logistic regression curves to generate a predicted age: predicted_age = (log(proportion / (1-proportion)) - b0)/ b1 (cite). We subtracted the predicted age from each child's chronological age to get the vocabulary delay variable.
<!-- eb: you're gonna want to be clearer on what the penultimate sentence means. where does that formula come from? why put prop/(1-prop)? what's b0 and b1? why take the log? if you dn't articulate that, your reader surely won't follow what you're doing -->


```{r wg-ws-rainbow-plot}
cowplot::plot_grid((plot_elssp_df(elssp_datasets[[1]])), (plot_elssp_df(elssp_datasets[[2]]))) +
  labs(caption = "Figures XXX - Colored lines show vocabulary percentiles from wordbank. black line shows growth curve from Wordbank 50th percentile data. Black triangles show vocabulary scores of individual DHH children.")

#need to make text and dots bigger
#caption doesn't show up, but idk why
# eb: that plot_elssp_df function is way more complicated than you need it to be (as evidenced by your not being sure why the graph is printing multiple times:)). simplify the code. get help from char/shan/fed for this.
```

To look at the relationship between our predictor variables and vocabulary delay, we conducted multiple linear regression, using vocabulary delay as the outcome variable. We also present Bonferroni-corrected zero-order correlations of each predictor on vocabulary delay. We exclude children from non-English-speaking families from this section of the analysis because our growth curves are based on the English language CDI.
<!-- eb: we can come back to this but no reason not to do the same thing for the spanish ones, right? 
also: you say you're reporting zero order correlations...but don't do so. do we need them?-->

Our full regression model included all variables except Language Background: Vocabulary Delay ~ Gender + Developmental Delay + Health Issues + Prematurity + Laterality + Degree + Amplification + Communication + Meets 1-3-6 + ServicesReceivedPerMonth. We performed stepwise model comparison using stepAIC (MASS) to pare down the model. This process selected only the predictors which incrementally improved model fit, measured by Akaike’s Information Criterion (AIC), which considers goodness of fit and model complexity (penalizing models with many predictors). Based on this iterative process, we removed Prematurity, Communication, Meets 1-3-6, and ServicesReceivedPerMonth from the model. 

```{r delay-AIC, include=F}
full_model_delay <- lm(diff_age_from_expected ~ Gender + DevelopmentalConcerns + IsPremature + HealthIssues + Laterality + HLworse + Amplification + Communication + Meets136, data = (full_elssp %>% filter(PrimaryLanguage == 'English' & Meets136!='')))

stepAIC(full_model_delay)

AIC_model_delay <- lm(formula = diff_age_from_expected ~ Gender + DevelopmentalConcerns + HealthIssues + Laterality + HLworse + Amplification, 
data = (full_elssp %>%  filter(PrimaryLanguage == "English")))
```


Our final model included: Vocabulary Delay ~ Gender + Developmental Delay + Health Issues + Laterality + Degree + Amplification. This model accounted for significant variance in children's vocabulary delay (adjusted-R2 = `r summary(AIC_model_delay)$adj.r.squared`, *p* = `r AIC_model_delay$p.value`). There were significant main effects of gender, developmental delay, laterality, degree, health issues, and amplification. In this model, being male `r beta_output(AIC_model_delay, 2)`, having a developmental delay `r beta_output(AIC_model_delay, 3)`, bilateral hearing loss `r beta_output(AIC_model_delay, 5)`, and more severe hearing loss predicted a larger delay `r beta_output(AIC_model_delay, 6)`. Having a cochlear implant `r beta_output(AIC_model_delay, 7)`or hearing aid `r beta_output(AIC_model_delay, 8)` predicted a smaller delay, relative to no amplification. Presence of health issues indicated a smaller vocabulary delay `r beta_output(AIC_model_delay, 4)`.  Although we showed in Part I that relationships exist among several of these variables (e.g., degree and amplification), a vif test on our model revealed that each predictor was responsible for a unique share of the variance (all GVIF < 3).
<!-- eb: in preceding paragraph, r2 should have superscripted 2, you should refer to some table where you have all the betas, your rsquared are in proportions so .35% isn't what you mean. You should include the results of your VIF test (not sure where that code is?) and cite the Statistical Learning in R book and it's rule of thumb for what the VIF scores can be without issue -->


```{r delay-betas}
dw_plot(AIC_model_delay) + 
  theme_classic() + 
  geom_vline(xintercept = 0) + 
  theme(legend.position = "none")
# eb: fix your axis labels, also this graph can be much smaller and still fine
```



```{r delay-plots, include=F}
#not sure whether I need these. Wasn't emotionally ready to take them out.. supplementals maybe?
#eb: i'm not sure if you need them but if you want to keep them they need an x axis, & you need to mention them in the text

plot_grid(bp_simple("IsPremature", "Premature"), bp_simple("HealthIssues", "Health Issues"), bp_simple("DevelopmentalConcerns", "Developmental Delay"), nrow = 3)

plot_grid(bp_simple("Gender", "Gender"), 
          bp_simple("Communication", "Communication"), bp_simple("Meets136", "Meets 1-3-6"), nrow=3)

plot_grid(bp_simple("Laterality", "Laterality"), bp_simple("Etiology", "Etiology"),
          bp_simple("Amplification", "Amplification"), nrow = 3)

```


## Part III: Meets136 success
```{r 136-summary-stats}

perc_136 <- (nrow(elssp%>%filter(Meets136=='yes'))/(nrow(elssp%>%filter(Meets136=='yes'|Meets136=='no'))))*100
perc_136_TD <- (nrow(elssp%>%filter(anycomorbid=='no')%>%filter(Meets136=='yes'))/(nrow(elssp%>%filter(anycomorbid=='no')%>%filter(Meets136=='yes'|Meets136=='no'))))*100
perc_136_DA <- (nrow(elssp%>%filter(anycomorbid=='yes')%>%filter(Meets136=='yes'))/(nrow(elssp%>%filter(anycomorbid=='yes')%>%filter(Meets136=='yes'|Meets136=='no'))))*100
```

Perhaps of greatest importance to clinicians and policymakers is the implementation and effect of existing policies. Lastly, we looked at the ages at which children received diagnosis and intervention, and how this mapped onto the 1-3-6 guidelines. Although we did not find 1-3-6 guidelines to significantly predict vocabulary delay in our sample, we wanted to examine the reach of 1-3-6 and discuss factors that may influence whether a given child receives early diagnosis and intervention. In this section, we provide a brief description of the implementation of 1-3-6 in our sample and describe the results of linear regression models for age at diagnosis and age at intervention. 
<!-- eb: do you mean that 1-3-6 wasn't in the final model? bc that doesn't mean it didnt' significantly predict vocab delay. is there a reasonable correlation between 1-3-6 & vocab delay? -->

Overall, `r round(perc_136)`% of our sample met 1-3-6 guidelines for early diagnosis and intervention (see \@ref(tab:CDIinfo)). Among the children for which screening information was available (n = `r nrow(elssp %>% filter(NBHS=='Y'))`), 100% were screened at birth or during NICU stay. `r round((nrow(elssp%>%filter(meets13=="yes"))/(nrow(elssp %>% filter(meets13=="yes"|meets13=="no"))))*100)`% of children received diagnosis by 3 months of age, and `r round((nrow(elssp%>%filter(meets6=="yes"))/(nrow(elssp %>% filter(meets6=="yes"|meets6=="no"))))*100)`% began early intervention by 6 months of age. Among children with comorbidities, `r perc_136_DA`% met 1-3-6 guidelines, compared to `r perc_136_TD`% of children without comorbidities. Figure \@ref(fig:meets136-timeline) shows the age at first diagnosis, intervention, amplification, and implantation for each child in our sample.


```{r meets136-timeline}
#not sure which plot is better
# eb: let's try putting the mean & SD in black on the graph with the dots and using that one
# eb: the code below needs a cleanup still; seek help from labmates. 

event <- c('Diagnosis','Intervention','Amplification', 'Implantation')
eventmin <- c(min(full_elssp$IdentificationOfHLMonths, na.rm = TRUE), min(full_elssp$AgeStartedServices, na.rm = TRUE), 
              min(full_elssp$AgeAmplification, na.rm = TRUE), min(full_elssp$AgeImplantation, na.rm = TRUE))
eventmax <- c(max(full_elssp$IdentificationOfHLMonths, na.rm = TRUE), max(full_elssp$AgeStartedServices, na.rm = TRUE), 
              max(full_elssp$AgeAmplification, na.rm = TRUE), max(full_elssp$AgeImplantation, na.rm = TRUE))
eventmean <- c(mean(full_elssp$IdentificationOfHLMonths, na.rm = TRUE), mean(full_elssp$AgeStartedServices, na.rm = TRUE), 
               mean(full_elssp$AgeAmplification, na.rm = TRUE), mean(full_elssp$AgeImplantation, na.rm = TRUE))
eventsd <- c(sd(full_elssp$IdentificationOfHLMonths, na.rm = TRUE), sd(full_elssp$AgeStartedServices, na.rm = TRUE), 
             sd(full_elssp$AgeAmplification, na.rm = TRUE), sd(full_elssp$AgeImplantation, na.rm = TRUE))
event_data <- data.frame(event, eventmin, eventmax, eventmean, eventsd)

ggplot(data = event_data, 
                    mapping = aes(x = reorder(event, eventmean), 
                                  y = eventmean, color=event)) + 
  geom_pointrange(mapping = aes(ymin = eventmean - eventsd,
                                ymax = eventmean + eventsd)) +
  geom_pointrange(mapping = aes(ymin = eventmin,
                                ymax = eventmax), width=2, alpha=0.5) +
  labs(x= "", y= "Age Months") + 
  coord_flip() +
  theme(legend.position = "none") +
  theme_classic() + 
  labs(caption = "Figure XXX - Dots represent average age of diagnosis, etc. Stronger lines represent standard deviation. Softer lines show range.")

elssp %>% 
  dplyr::select(VIHI_ID, IdentificationOfHLMonths, AgeStartedServices, AgeImplantation, AgeAmplification) %>%
  pivot_longer(cols = IdentificationOfHLMonths:AgeAmplification, names_to = "event", values_to = "age") %>%
  ggplot(aes(x = event, y = age, fill = event, color = event)) +
  geom_violin(alpha = .4) +
  geom_jitter() + 
  coord_flip() +
  theme_classic() +
  theme(legend.position = "none") +
  labs(x = '', y ='Age (months)')


```

```{r lm-stats, include=F}
# i want to look through the residuals plots with you

stepAIC(lm(IdentificationOfHLMonths ~ Gender + 
             Etiology +
             HLworse + 
             Laterality + 
             IsPremature + 
             HealthIssues + 
             DevelopmentalConcerns + 
             Monolingual_English + 
             VisionLoss + 
             ANSD, 
           (data=elssp %>% 
              filter(HLworse!="NA" & Etiology!=''))))
#Health issues , primary language

diagnosis_aic <- lm(formula = IdentificationOfHLMonths ~ HealthIssues + Monolingual_English + Laterality, data = elssp)

stepAIC(lm(AgeStartedServices ~ Gender + 
             Etiology +
             HLworse + 
             Laterality + 
             HealthIssues + 
             IsPremature + 
             DevelopmentalConcerns + 
             Monolingual_English + 
             Communication + 
             VisionLoss + 
             ANSD + 
             IdentificationOfHLMonths,
           (data=elssp %>% filter(HLworse!="NA"& Etiology!='')))) 

services_aic <- lm(formula = AgeStartedServices ~ HLworse + IsPremature + 
                       IdentificationOfHLMonths + Monolingual_English, data = elssp)


difference_aic <- lm(formula = (AgeStartedServices - IdentificationOfHLMonths) ~ 
    HLworse + IsPremature + Monolingual_English + IdentificationOfHLMonths, 
    data = elssp)
```
We created two linear regression models, one for age at diagnosis and one for age at intervention. For each model, we started with the set of predictors that would have been present prior to or during diagnosis or intervention, respectively. We then pared down each model using stepwise regression by AIC (MASS package), using the process described above in Part II of Results. For age at diagnosis, we included the set of child-specific factors that would be relevant *before* diagnosis of hearing loss (e.g., we excluded amplification type because a child would not receive a hearing aid or cochlear implant prior to being diagnosed with hearing loss.) We began with: gender, degree, developmental delay, health issues, prematurity, laterality, language background, and etiology.
<!-- eb you've just been talking about 4 events, need to say why you're picking 2 of them to model -->


Model selection removed gender, degree, developmental delay, prematurity, laterality, and etiology as predictors. Under the best fit model (R2=`r summary(diagnosis_aic)$r.squared` , p=`r lm_pvalue(diagnosis_aic)`), children with no additional health issues `r beta_output(diagnosis_aic, 2)`, children from English-speaking households `r beta_output(diagnosis_aic, 3)`, and children with unilateral hearing loss `r beta_output(diagnosis_aic, 4)` were earlier diagnosed. Presence of health issues indicated a `r diagnosis_aic$coefficients[[2]]` months later diagnosis, and coming from a non-English-speaking household resulted in a `r diagnosis_aic$coefficients[[3]]` months later diagnosis. This model accounted for roughly `r summary(diagnosis_aic)$r.squared`% of the variance in age at diagnosis.
$$Age\:at\:Diagnosis \sim Health\:Issues + Language\:Background$$


```{r diagnosis-betas}
dwplot(diagnosis_aic) + 
  geom_vline(xintercept=0, linetype = 'dashed') + 
  theme_classic()+ theme(legend.position="none")
options(repr.plot.width=6, repr.plot.height=4)
#caption: 
```


We repeated this model selection process for age at intervention. Our starting model included the variables potentially relevant to intervention: 
Age intervention ~ gender + degree (worse ear) + developmental delay + health issues + prematurity + laterality + language background + etiology + age diagnosis
Model selection by AIC removed Gender, Developmental Delay, Health Issues, Prematurity, Language Background, and Etiology. In the best fit model (R2=`r summary(services_aic)$r.squared` , p=`r lm_pvalue(services_aic)`), prematurity `r beta_output(services_aic, 3)`, less severe hearing loss `r beta_output(services_aic, 2)`, later diagnosis `r beta_output(services_aic, 4)`, and coming from a non-English-speaking household `r beta_output(services_aic, 5)` predicted later intervention and accounted for roughly `r summary(services_aic)$r.squared`% of the variance in age at intervention. Infants born premature were diagnosed `r services_aic$coefficients[[3]]` months later than full-term infants. A 1 decibel increase in hearing loss results in `r abs((services_aic$coefficients[[2]])*30.4167)` days earlier intervention. Each one month delay in diagnosis results in a `r abs(services_aic$coefficients[[5]])` month delay in intervention.
$$Age\:at\:Intervention \sim Degree\:of\:Hearing\:Loss\:(worse\:ear) + Prematurity + Age\:at\:Diagnosis$$

<!-- eb: there's some redundancy across your two model results in this section aren't you starting with the same full set of predictors for both? if so just list them once.  you don't have to say what was removed from the model, just say the final model for each. i would just put it in regular type instad of the equation format. also you both write your betas parenthetically but then for some of them reword them as months of delay or whatever. consolidate that redundancy. same thing as above for .XX% should be XX%, r^2 superscript formatting, etc. Do an edit for causal language, e.g. 1db increase in hearing loss doesn't *result* in x days earlier intervention -->

```{r intervention-betas}
dwplot(services_aic) + geom_vline(xintercept=0, linetype = 'dashed') + 
  theme_classic() + 
  theme(legend.position="none")
options(repr.plot.width=6, repr.plot.height=4)

#caption:  
```
# Discussion

*(This isn't ready yet)*
Prematurity, health issues, and developmental delay frequently co-occurred, such that there was a moderate relationship between each of these variables (cramer’s V = 0.38 - 0.52, p < .0007). Children with one of these conditions (prematurity, developmental delay, health issues) were more likely to have any other condition. This is not surprising. Many conditions that cause developmental delays have a high incidence of health issues (e.g., heart problems in Down Syndrome; vomiting and seizures with hydrocephalus), and it is well documented that there is a higher incidence of developmental delay in preterm infants [@pierrat2017; @aardnoudse-moens2009]. Children born premature, especially those born extremely premature, are at increased risk for a number of health issues at birth (CITE) and throughout the lifespan (CITE). 
Each of these conditions may affect language and development in different ways. The literature points to increased risk of language delay for children with developmental delays (CITE) and children born premature(CITE), with differential effects based on the nature of the developmental delay (CITE) or the gestation duration (CITE). Together, these risks may interact and multiply. In our sample, we also had a large range of health conditions (76 unique conditions in our sample of 100 children), and it appears probable that those conditions would vary in whether and how they influence vocabulary growth. Unfortunately, we lack sufficient Ns to measure the unique effect of each condition. 
We found that children with developmental delays (e.g., Down syndrome) were much more likely to use a total communication approach than typically-developing DHH children. Assignment to “spoken language” and “total communication” groups was not random, with use of total communication appearing to follow children already at greater risk for verbal delays. Additionally, in our sample, children with developmental delays were considerably more likely to receive >10 services per month, perhaps accounting for increased need (or increased perceived need). The services per month variable also includes occupational therapy, physical therapy, which typically-developing DHH children may be unlikely to receive. Likewise, children who used total communication were more likely to receive frequent services.
We also found relationships among many of our audiological variables. In particular, etiology and laterality were related, such that conductive hearing loss was more likely unilateral, and sensorineural hearing loss was more likely bilateral. There were only seven cases of mixed hearing loss, and all were bilateral. One possible explanation is that certain underlying causes of conductive hearing loss (e.g., aural atresia, impacted cerumen, trauma to the tympanic membrane) may be more likely to affect one ear than two.
Amplification devices were more common for children with less hearing (i.e., children with bilateral hearing loss and children with moderate to profound hearing loss). This may be due to the assumption that a hearing aid or cochlear implant will not benefit children with minimal hearing loss (Updike, 1994), although several studies have found benefits in speech perception and quality of life for amplification for unilateral hearing loss  (Hassepass et al., 2013;   priwin et al., 2007; briggs et al., 2011; dwyer et al., 2014) and spoken language vocabulary and grammar for mild hearing loss (walker et al., 2015).


# Conclusion





Footnotes: Despite exciting, increasing, and converging evidence for benefits of early sign language exposure [e.g., @schick2007; @spencer1993; @davidson2014; @magnuson2000; @clark2016; @hrastinski2016], the majority of DHH children will not be raised in a sign language environment. This is particularly true for North Carolina, which does not have a large community of sign language users, relative to states like Maryland or areas like Washington D.C. or Rochester, NY. For this reason, we focus on spoken language development. 



# References
